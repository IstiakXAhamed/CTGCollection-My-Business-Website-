"use strict";exports.id=455,exports.ids=[455],exports.modules={90455:(e,r,n)=>{n.d(r,{Gv:()=>u,RA:()=>d,V3:()=>c,c_:()=>a,verifyToken:()=>l});var t=n(98691),i=n(6091),s=n(6176);n(71615);let o=new TextEncoder().encode(process.env.JWT_SECRET||"your-secret-key");async function a(e){return t.ZP.hash(e,10)}async function u(e,r){return t.ZP.compare(e,r)}async function c(e){return new i.N(e).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime("7d").sign(o)}async function l(e){try{return(await (0,s._)(e,o)).payload}catch(e){return null}}async function d(e){try{let r=e.cookies.get("token")?.value;if(!r)return null;let t=await l(r);if(!t)return null;let{prisma:i}=await n.e(7356).then(n.bind(n,72331)),s=await i.user.findUnique({where:{id:t.userId},select:{id:!0,email:!0,role:!0,name:!0,isActive:!0,permissions:!0}});if(!s||!1===s.isActive)return null;return{id:s.id,userId:s.id,email:s.email,name:s.name,role:s.role,permissions:s.permissions||[]}}catch(e){return console.error("verifyAuth error:",e),null}}}};