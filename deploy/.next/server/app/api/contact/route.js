"use strict";(()=>{var e={};e.id=386,e.ids=[386,7356],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},67226:(e,a,r)=>{r.r(a),r.d(a,{originalPathname:()=>f,patchFetch:()=>g,requestAsyncStorage:()=>m,routeModule:()=>p,serverHooks:()=>y,staticGenerationAsyncStorage:()=>h});var t={};r.r(t),r.d(t,{POST:()=>l,dynamic:()=>d});var n=r(49303),o=r(88716),s=r(60670),i=r(87070),c=r(72331),u=r(76876);let d="force-dynamic";async function l(e){try{let{name:a,email:r,phone:t,subject:n,message:o}=await e.json();if(!a||!r||!n||!o)return i.NextResponse.json({error:"Name, email, subject and message are required"},{status:400});if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r))return i.NextResponse.json({error:"Invalid email address"},{status:400});let s=await c.prisma.contactMessage.create({data:{name:a,email:r,phone:t||null,subject:n,message:o}});try{await (0,u.rB)(a,n)}catch(e){console.log("Notification error (non-blocking):",e)}return i.NextResponse.json({success:!0,message:"Message sent successfully! We will get back to you soon.",id:s.id})}catch(e){return console.error("Contact form error:",e),i.NextResponse.json({error:"Failed to send message. Please try again."},{status:500})}}let p=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/contact/route",pathname:"/api/contact",filename:"route",bundlePath:"app/api/contact/route"},resolvedPagePath:"C:\\Users\\samia\\Desktop\\Learning Journey\\HostNin\\SilkMartWebSite\\app\\api\\contact\\route.ts",nextConfigOutput:"standalone",userland:t}),{requestAsyncStorage:m,staticGenerationAsyncStorage:h,serverHooks:y}=p,f="/api/contact/route";function g(){return(0,s.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:h})}},76876:(e,a,r)=>{r.d(a,{A5:()=>h,Eb:()=>f,En:()=>l,KY:()=>g,NF:()=>u,Yp:()=>c,an:()=>i,f_:()=>w,ko:()=>p,oX:()=>y,rB:()=>m,r_:()=>s,wN:()=>d});var t=r(72331);async function n(e,a,r,n,o){try{return await t.prisma.notification.create({data:{userId:e,type:a,title:r,message:n,link:o||null}}),!0}catch(e){return console.error("Failed to create notification:",e),!1}}async function o(e,a,r,n){try{let o=await t.prisma.user.findMany({where:{role:{in:["admin","superadmin"]}},select:{id:!0}});return await Promise.all(o.map(o=>t.prisma.notification.create({data:{userId:o.id,type:e,title:a,message:r,link:n||null}}))),!0}catch(e){return console.error("Failed to notify admins:",e),!1}}async function s(e,a,r){await o("order","\uD83D\uDED2 New Order Received!",`${a} placed an order (৳${r.toLocaleString()})`,"/admin/orders")}async function i(e,a){await n(e,"order","✅ Order Confirmed!","Your order has been confirmed and is being processed.","/dashboard/orders")}async function c(e,a,r){await n(e,"order","\uD83D\uDCE6 Order Shipped!",`Your order is on the way!${r?` Tracking: ${r}`:""}`,"/dashboard/orders")}async function u(e,a){await n(e,"order","\uD83C\uDF89 Order Delivered!","Your order has been delivered. Thank you for shopping with us!","/dashboard/orders")}async function d(e,a,r){await n(e,"order","❌ Order Cancelled",r||"Your order has been cancelled.","/dashboard/orders")}async function l(e,a){await n(e,"welcome","\uD83C\uDF89 Welcome to CTG Collection!",`Hi ${a}, thank you for joining us! Explore our amazing products.`,"/shop")}async function p(e,a){await o("user","\uD83D\uDC64 New User Registered!",`${e} (${a}) just joined.`,"/admin/customers")}async function m(e,a){await o("message","\uD83D\uDCE7 New Contact Message!",`${e}: "${a}"`,"/admin/messages")}async function h(e,a){await o("chat","\uD83D\uDCAC New Chat Message!",`${e} sent a message`,"/admin/chat")}async function y(e,a,r){let t={customer:"Customer",seller:"Seller",admin:"Admin",superadmin:"Super Admin"}[r]||r,o=["admin","seller","superadmin"].includes(r)&&"customer"===a;await n(e,"account",o?"\uD83C\uDF8A Congratulations! Role Upgraded":"\uD83D\uDCCB Account Role Updated",o?`You have been promoted to ${t}! Welcome to the team.`:`Your account role has been changed to ${t}.`,"/dashboard")}async function f(e,a){await n(e,"loyalty","\uD83C\uDFC6 Membership Tier Updated!",`Congratulations! You are now a ${a} member. Enjoy exclusive benefits!`,"/dashboard/loyalty")}async function g(e){await n(e,"account","⚠️ Account Deactivated","Your account has been temporarily deactivated. Please contact support for assistance.",void 0)}async function w(e){await n(e,"account","✅ Account Reactivated","Great news! Your account has been reactivated. Welcome back!","/dashboard")}},72331:(e,a,r)=>{r.d(a,{prisma:()=>o});var t=r(53524);let n=globalThis,o=n.prisma??new t.PrismaClient({log:["error"]});n.prisma=o}};var a=require("../../../webpack-runtime.js");a.C(e);var r=e=>a(a.s=e),t=a.X(0,[8948,5972],()=>r(67226));module.exports=t})();