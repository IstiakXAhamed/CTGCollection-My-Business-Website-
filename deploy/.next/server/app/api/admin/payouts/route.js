"use strict";(()=>{var e={};e.id=346,e.ids=[346,7356],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},61282:e=>{e.exports=require("child_process")},84770:e=>{e.exports=require("crypto")},80665:e=>{e.exports=require("dns")},17702:e=>{e.exports=require("events")},92048:e=>{e.exports=require("fs")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},98216:e=>{e.exports=require("net")},19801:e=>{e.exports=require("os")},55315:e=>{e.exports=require("path")},76162:e=>{e.exports=require("stream")},82452:e=>{e.exports=require("tls")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},24872:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>h,patchFetch:()=>y,requestAsyncStorage:()=>m,routeModule:()=>c,serverHooks:()=>q,staticGenerationAsyncStorage:()=>x});var s={};t.r(s),t.d(s,{GET:()=>d,PUT:()=>l,dynamic:()=>u});var a=t(49303),i=t(88716),o=t(60670),n=t(87070),p=t(72331);let u="force-dynamic";async function d(e){try{let{searchParams:r}=new URL(e.url),t=r.get("status"),s={};t&&"all"!==t&&(s.status=t);let a=await p.prisma.payoutRequest.findMany({where:s,include:{user:{select:{name:!0,email:!0,shop:{select:{name:!0}}}}},orderBy:{createdAt:"desc"}});return n.NextResponse.json({payouts:a})}catch(e){return n.NextResponse.json({error:"Failed"},{status:500})}}async function l(e){try{let{id:r,action:s,note:a}=await e.json();if(!r||!s)return n.NextResponse.json({error:"Missing fields"},{status:400});let i="pending";"approve"===s&&(i="approved"),"reject"===s&&(i="rejected"),"mark_paid"===s&&(i="paid");let o=await p.prisma.payoutRequest.update({where:{id:r},data:{status:i,adminNote:a,processedAt:new Date}});return o.user?.email&&"pending"!==i&&Promise.all([t.e(5245),t.e(6119)]).then(t.bind(t,36119)).then(({sendPayoutStatusEmail:e})=>{e(o.user.email,o.amount,i,a||"").catch(console.error)}),n.NextResponse.json({success:!0,payout:o})}catch(e){return n.NextResponse.json({error:"Failed"},{status:500})}}let c=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/admin/payouts/route",pathname:"/api/admin/payouts",filename:"route",bundlePath:"app/api/admin/payouts/route"},resolvedPagePath:"C:\\Users\\samia\\Desktop\\Learning Journey\\HostNin\\SilkMartWebSite\\app\\api\\admin\\payouts\\route.ts",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:x,serverHooks:q}=c,h="/api/admin/payouts/route";function y(){return(0,o.patchFetch)({serverHooks:q,staticGenerationAsyncStorage:x})}},72331:(e,r,t)=>{t.d(r,{prisma:()=>i});var s=t(53524);let a=globalThis,i=a.prisma??new s.PrismaClient({log:["error"]});a.prisma=i}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[8948,5972],()=>t(24872));module.exports=s})();