(()=>{var e={};e.id=9674,e.ids=[9674],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},52544:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>c,routeModule:()=>p,tree:()=>o}),t(89049),t(90596),t(81027),t(35866);var a=t(23191),r=t(88716),i=t(37922),l=t.n(i),n=t(95231),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);t.d(s,d);let o=["",{children:["admin",{children:["users",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,89049)),"C:\\Users\\samia\\Desktop\\Learning Journey\\HostNin\\SilkMartWebSite\\app\\admin\\users\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,90596)),"C:\\Users\\samia\\Desktop\\Learning Journey\\HostNin\\SilkMartWebSite\\app\\admin\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,81027)),"C:\\Users\\samia\\Desktop\\Learning Journey\\HostNin\\SilkMartWebSite\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\samia\\Desktop\\Learning Journey\\HostNin\\SilkMartWebSite\\app\\admin\\users\\page.tsx"],m="/admin/users/page",x={require:t,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/admin/users/page",pathname:"/admin/users",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},79157:(e,s,t)=>{Promise.resolve().then(t.bind(t,20131))},20131:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>b});var a=t(10326),r=t(17577),i=t(33071),l=t(90772),n=t(54432),d=t(60763),o=t(58038),c=t(55671),m=t(79635),x=t(21405),p=t(8798),u=t(88307),h=t(30123),g=t(30361),j=t(98091),f=t(99440),v=t(94215),N=t(16884);let y={superadmin:{icon:d.Z,color:"bg-purple-100 text-purple-800",label:"Super Admin"},admin:{icon:o.Z,color:"bg-indigo-100 text-indigo-800",label:"Admin"},seller:{icon:c.Z,color:"bg-blue-100 text-blue-800",label:"Seller"},customer:{icon:m.Z,color:"bg-gray-100 text-gray-800",label:"Customer"}};function b(){let[e,s]=(0,r.useState)([]),[t,d]=(0,r.useState)(!0),[b,w]=(0,r.useState)(!1),[k,S]=(0,r.useState)(""),[C,A]=(0,r.useState)("all"),[z,Z]=(0,r.useState)(!1),[_,P]=(0,r.useState)(null),[D,U]=(0,r.useState)("promote_admin"),{toast:$}=(0,v.pm)(),M=async()=>{d(!0);try{let e=new URLSearchParams;"all"!==C&&e.set("role",C);let t=await fetch(`/api/admin/users?${e}`,{credentials:"include"});if(t.ok){let e=await t.json();s(e.users||[]),w(e.isSuperAdmin||!1)}else 403===t.status&&$({title:"Access Denied",description:"You do not have permission to view this page",variant:"destructive"})}catch(e){console.error("Failed to fetch users:",e)}finally{d(!1)}},T=async(e,s)=>{try{let t=await fetch("/api/admin/users",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({userId:e,role:s})});if(t.ok)$({title:"Success",description:`User role updated to ${s}`}),M();else{let e=await t.json();$({title:"Error",description:e.error,variant:"destructive"})}}catch(e){$({title:"Error",description:"Failed to update role",variant:"destructive"})}Z(!1)},R=async(e,s)=>{try{let t=await fetch("/api/admin/users",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({userId:e,isActive:s})});if(t.ok)$({title:"Success",description:`User ${s?"activated":"deactivated"}`}),M();else{let e=await t.json();$({title:"Error",description:e.error,variant:"destructive"})}}catch(e){$({title:"Error",description:"Failed to update user",variant:"destructive"})}Z(!1)},L=async e=>{try{let s=await fetch(`/api/admin/users?userId=${e}`,{method:"DELETE",credentials:"include"});if(s.ok)$({title:"Success",description:"User deleted successfully"}),M();else{let e=await s.json();$({title:"Error",description:e.error,variant:"destructive"})}}catch(e){$({title:"Error",description:"Failed to delete user",variant:"destructive"})}Z(!1)},E=(e,s)=>{P(e),U(s),Z(!0)},F=e.filter(e=>e.name?.toLowerCase().includes(k.toLowerCase())||e.email?.toLowerCase().includes(k.toLowerCase()));return t?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(x.Z,{className:"w-8 h-8 animate-spin text-blue-600"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold mb-2 flex items-center gap-2",children:[a.jsx(p.Z,{className:"w-8 h-8"}),"User Management"]}),a.jsx("p",{className:"text-muted-foreground",children:b?"Manage user roles and permissions":"View registered users"})]}),(0,a.jsxs)(l.z,{onClick:M,variant:"outline",children:[a.jsx(x.Z,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),(0,a.jsxs)("div",{className:"flex gap-4 flex-wrap",children:[(0,a.jsxs)("div",{className:"relative flex-1 min-w-[200px]",children:[a.jsx(u.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),a.jsx(n.I,{placeholder:"Search by name or email...",value:k,onChange:e=>S(e.target.value),className:"pl-10"})]}),(0,a.jsxs)("select",{value:C,onChange:e=>A(e.target.value),className:"h-10 px-4 rounded-md border bg-background",children:[a.jsx("option",{value:"all",children:"All Roles"}),a.jsx("option",{value:"superadmin",children:"Super Admin"}),a.jsx("option",{value:"admin",children:"Admin"}),a.jsx("option",{value:"seller",children:"Seller"}),a.jsx("option",{value:"customer",children:"Customer"})]})]}),a.jsx("div",{className:"flex gap-4 text-sm flex-wrap",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-muted-foreground",children:"Badges:"}),a.jsx(N.Z,{role:"superadmin",size:"sm"}),a.jsx(N.Z,{role:"admin",size:"sm"}),a.jsx(N.Z,{role:"seller",size:"sm"}),a.jsx(N.Z,{role:"customer",size:"sm"})]})}),a.jsx(i.Zb,{children:(0,a.jsxs)(i.aY,{className:"p-0",children:[a.jsx("div",{className:"grid grid-cols-1 gap-4 md:hidden",children:F.map(e=>(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg border shadow-sm space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"font-semibold",children:e.name}),a.jsx("p",{className:"text-sm text-muted-foreground",children:e.email})]}),a.jsx(N.Z,{role:e.role,tier:e.loyaltyPoints?.tier?.name,size:"sm"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm border-t pt-3 border-gray-100",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-muted-foreground",children:"Status:"}),a.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold ${!1!==e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:!1!==e.isActive?"Active":"Inactive"})]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-muted-foreground",children:"Orders:"})," ",e._count?.orders||0]})]}),b&&"superadmin"!==e.role&&(0,a.jsxs)("div",{className:"pt-3 flex flex-wrap gap-2 border-t border-gray-100 justify-end",children:["customer"===e.role?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l.z,{size:"sm",variant:"outline",onClick:()=>E(e,"promote_admin"),className:"h-8 text-indigo-600 border-indigo-200 hover:bg-indigo-50",children:[a.jsx(o.Z,{className:"w-4 h-4 mr-1"})," Admin"]}),(0,a.jsxs)(l.z,{size:"sm",variant:"outline",onClick:()=>E(e,"promote_seller"),className:"h-8 text-blue-600 border-blue-200 hover:bg-blue-50",children:[a.jsx(c.Z,{className:"w-4 h-4 mr-1"})," Seller"]})]}):(0,a.jsxs)(l.z,{size:"sm",variant:"outline",onClick:()=>E(e,"demote"),className:"h-8 text-orange-600 border-orange-200 hover:bg-orange-50",children:[a.jsx(m.Z,{className:"w-4 h-4 mr-1"})," Demote"]}),a.jsx(l.z,{size:"sm",variant:"outline",onClick:()=>E(e,"toggle"),className:`h-8 w-8 p-0 ${!1!==e.isActive?"text-orange-600 border-orange-200":"text-green-600 border-green-200"}`,children:!1!==e.isActive?a.jsx(h.Z,{className:"w-4 h-4"}):a.jsx(g.Z,{className:"w-4 h-4"})}),a.jsx(l.z,{size:"sm",variant:"outline",onClick:()=>E(e,"delete"),className:"h-8 w-8 p-0 text-red-600 border-red-200 hover:bg-red-50",children:a.jsx(j.Z,{className:"w-4 h-4"})})]})]},e.id))}),a.jsx("div",{className:"hidden md:block overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[a.jsx("thead",{children:(0,a.jsxs)("tr",{className:"border-b bg-gray-50",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"User"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Role"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Orders"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Joined"}),b&&a.jsx("th",{className:"text-right py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:F.map(e=>((y[e.role]||y.customer).icon,(0,a.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[a.jsx("td",{className:"py-4 px-4",children:(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-semibold",children:e.name}),a.jsx("p",{className:"text-sm text-muted-foreground",children:e.email})]})}),a.jsx("td",{className:"py-4 px-4",children:a.jsx(N.Z,{role:e.role,tier:e.loyaltyPoints?.tier?.name,size:"sm"})}),a.jsx("td",{className:"py-4 px-4",children:a.jsx("span",{className:"text-sm",children:e._count?.orders||0})}),a.jsx("td",{className:"py-4 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${!1!==e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:!1!==e.isActive?"Active":"Inactive"})}),a.jsx("td",{className:"py-4 px-4 text-sm text-muted-foreground",children:new Date(e.createdAt).toLocaleDateString()}),b&&a.jsx("td",{className:"py-4 px-4",children:(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:["superadmin"!==e.role&&(0,a.jsxs)(a.Fragment,{children:["customer"===e.role?(0,a.jsxs)(a.Fragment,{children:[a.jsx(l.z,{size:"sm",variant:"outline",onClick:()=>E(e,"promote_admin"),className:"text-indigo-600",title:"Make Admin",children:a.jsx(o.Z,{className:"w-4 h-4"})}),a.jsx(l.z,{size:"sm",variant:"outline",onClick:()=>E(e,"promote_seller"),className:"text-blue-600",title:"Make Seller",children:a.jsx(c.Z,{className:"w-4 h-4"})})]}):(0,a.jsxs)(l.z,{size:"sm",variant:"outline",onClick:()=>E(e,"demote"),className:"text-orange-600",title:"Demote to Customer",children:[a.jsx(m.Z,{className:"w-4 h-4 mr-1"}),"Demote"]}),a.jsx(l.z,{size:"sm",variant:"outline",onClick:()=>E(e,"toggle"),className:!1!==e.isActive?"text-orange-600":"text-green-600",children:!1!==e.isActive?a.jsx(a.Fragment,{children:a.jsx(h.Z,{className:"w-4 h-4"})}):a.jsx(a.Fragment,{children:a.jsx(g.Z,{className:"w-4 h-4"})})}),a.jsx(l.z,{size:"sm",variant:"outline",onClick:()=>E(e,"delete"),className:"text-red-600",children:a.jsx(j.Z,{className:"w-4 h-4"})})]}),"superadmin"===e.role&&a.jsx("span",{className:"text-xs text-muted-foreground italic",children:"Protected"})]})})]},e.id)))})]})})]})}),a.jsx(f.aR,{open:z,onOpenChange:Z,children:(0,a.jsxs)(f._T,{children:[(0,a.jsxs)(f.fY,{children:[(0,a.jsxs)(f.f$,{children:["promote_admin"===D&&"Promote to Admin","promote_seller"===D&&"Promote to Seller","demote"===D&&"Remove Privileges","toggle"===D&&(_?.isActive!==!1?"Deactivate User":"Activate User"),"delete"===D&&"Delete User"]}),(0,a.jsxs)(f.yT,{children:["promote_admin"===D&&`Make ${_?.name} an Admin? They will have full access except superadmin features.`,"promote_seller"===D&&`Make ${_?.name} a Seller? They will have restricted access (Orders, Products, Messages only).`,"demote"===D&&`Remove privileges from ${_?.name}? They will become a regular customer.`,"toggle"===D&&(_?.isActive!==!1?`Deactivate ${_?.name}? They won't be able to login.`:`Activate ${_?.name}? They will be able to login again.`),"delete"===D&&`Permanently delete ${_?.name}? This action cannot be undone.`]})]}),(0,a.jsxs)(f.xo,{children:[a.jsx(f.le,{children:"Cancel"}),a.jsx(f.OL,{onClick:()=>{"promote_admin"===D?T(_.id,"admin"):"promote_seller"===D?T(_.id,"seller"):"demote"===D?T(_.id,"customer"):"toggle"===D?R(_.id,!1===_.isActive):"delete"===D&&L(_.id)},className:"delete"===D?"bg-red-600 hover:bg-red-700":"",children:"Confirm"})]})]})})]})}},99440:(e,s,t)=>{"use strict";t.d(s,{OL:()=>g,_T:()=>m,aR:()=>d,f$:()=>u,fY:()=>x,le:()=>j,xo:()=>p,yT:()=>h});var a=t(10326),r=t(17577),i=t(95459),l=t(77863),n=t(90772);let d=i.fC;i.xz;let o=i.h_,c=r.forwardRef(({className:e,...s},t)=>a.jsx(i.aV,{className:(0,l.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...s,ref:t}));c.displayName=i.aV.displayName;let m=r.forwardRef(({className:e,...s},t)=>(0,a.jsxs)(o,{children:[a.jsx(c,{}),a.jsx(i.VY,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...s})]}));m.displayName=i.VY.displayName;let x=({className:e,...s})=>a.jsx("div",{className:(0,l.cn)("flex flex-col space-y-2 text-center sm:text-left",e),...s});x.displayName="AlertDialogHeader";let p=({className:e,...s})=>a.jsx("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...s});p.displayName="AlertDialogFooter";let u=r.forwardRef(({className:e,...s},t)=>a.jsx(i.Dx,{ref:t,className:(0,l.cn)("text-lg font-semibold",e),...s}));u.displayName=i.Dx.displayName;let h=r.forwardRef(({className:e,...s},t)=>a.jsx(i.dk,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",e),...s}));h.displayName=i.dk.displayName;let g=r.forwardRef(({className:e,...s},t)=>a.jsx(i.aU,{ref:t,className:(0,l.cn)((0,n.d)(),e),...s}));g.displayName=i.aU.displayName;let j=r.forwardRef(({className:e,...s},t)=>a.jsx(i.$j,{ref:t,className:(0,l.cn)((0,n.d)({variant:"outline"}),"mt-2 sm:mt-0",e),...s}));j.displayName=i.$j.displayName},55671:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(62881).Z)("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},30123:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(62881).Z)("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]])},89049:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`C:\Users\samia\Desktop\Learning Journey\HostNin\SilkMartWebSite\app\admin\users\page.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[8948,717,7956,9149,944,8777],()=>t(52544));module.exports=a})();