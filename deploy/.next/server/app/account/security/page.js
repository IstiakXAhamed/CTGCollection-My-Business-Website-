(()=>{var e={};e.id=7004,e.ids=[7004],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2848:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>x,tree:()=>c}),s(18512),s(81027),s(35866);var a=s(23191),r=s(88716),i=s(37922),n=s.n(i),l=s(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let c=["",{children:["account",{children:["security",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,18512)),"C:\\Users\\samia\\Desktop\\Learning Journey\\HostNin\\SilkMartWebSite\\app\\account\\security\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,81027)),"C:\\Users\\samia\\Desktop\\Learning Journey\\HostNin\\SilkMartWebSite\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\samia\\Desktop\\Learning Journey\\HostNin\\SilkMartWebSite\\app\\account\\security\\page.tsx"],u="/account/security/page",m={require:s,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/account/security/page",pathname:"/account/security",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},28077:(e,t,s)=>{Promise.resolve().then(s.bind(s,17100))},17100:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var a=s(10326),r=s(17577),i=s(35047),n=s(16721),l=s(77506),o=s(5932),c=s(32933),d=s(50949),u=s(58038),m=s(42887),x=s(90772),h=s(33071),p=s(96655),f=s(90434);function b(){let e=(0,i.useRouter)(),[t,s]=(0,r.useState)(!0),[b,y]=(0,r.useState)(!1),[g,j]=(0,r.useState)(null),[w,v]=(0,r.useState)(!1),[N,k]=(0,r.useState)("email"),[S,C]=(0,r.useState)(!1),[P,A]=(0,r.useState)("enable"),[Z,E]=(0,r.useState)(""),[M,R]=(0,r.useState)(!1),[T,_]=(0,r.useState)({type:"",text:""}),D=async()=>{try{let t=await fetch("/api/auth/me");if(t.ok){let e=await t.json();j(e.user),v(e.user.twoFactorEnabled||!1),k(e.user.twoFactorMethod||"email")}else e.push("/login")}catch(e){console.error("Failed to fetch user:",e)}finally{s(!1)}},F=async()=>{if(w)A("disable"),C(!0);else{A("enable"),y(!0);try{let e=await fetch("/api/user/settings/2fa",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"send-code",method:N})}),t=await e.json();e.ok?(C(!0),_({type:"success",text:"Verification code sent to your email"})):_({type:"error",text:t.message})}catch(e){_({type:"error",text:"Failed to send verification code"})}finally{y(!1)}}},O=async()=>{R(!0);try{let e=await fetch("/api/user/settings/2fa",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:P,method:N,code:Z})}),t=await e.json();e.ok?(v("enable"===P),C(!1),E(""),_({type:"success",text:"enable"===P?"Two-factor authentication enabled successfully!":"Two-factor authentication disabled"}),D()):_({type:"error",text:t.message})}catch(e){_({type:"error",text:"Operation failed"})}finally{R(!1)}};return t?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx(l.Z,{className:"w-8 h-8 animate-spin text-blue-600"})}):a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 py-12 px-4",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-8",children:[a.jsx(f.default,{href:"/account",className:"text-blue-600 hover:underline text-sm mb-2 inline-block",children:"â† Back to Account"}),a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Security Settings"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your account security and two-factor authentication"})]}),T.text&&a.jsx(n.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:`mb-6 p-4 rounded-lg ${"success"===T.type?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:T.text}),a.jsx(h.Zb,{className:"mb-6",children:a.jsx(h.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${g?.emailVerified?"bg-green-100":"bg-yellow-100"}`,children:a.jsx(o.Z,{className:`w-6 h-6 ${g?.emailVerified?"text-green-600":"text-yellow-600"}`})}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"font-semibold",children:"Email Verification"}),a.jsx("p",{className:"text-sm text-gray-500",children:g?.email})]})]}),a.jsx("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium ${g?.emailVerified?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:g?.emailVerified?(0,a.jsxs)(a.Fragment,{children:[a.jsx(c.Z,{className:"w-4 h-4"}),"Verified"]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(d.Z,{className:"w-4 h-4"}),"Not Verified"]})})]})})}),(0,a.jsxs)(h.Zb,{children:[(0,a.jsxs)(h.Ol,{children:[(0,a.jsxs)(h.ll,{className:"flex items-center gap-2",children:[a.jsx(u.Z,{className:"w-5 h-5 text-blue-600"}),"Two-Factor Authentication"]}),a.jsx(h.SZ,{children:"Add an extra layer of security to your account by requiring a verification code when you sign in."})]}),(0,a.jsxs)(h.aY,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"font-medium",children:"Enable 2FA"}),a.jsx("p",{className:"text-sm text-gray-500",children:w?"Your account is protected with 2FA":"Protect your account with two-factor authentication"})]}),a.jsx(p.r,{checked:w,onCheckedChange:F,disabled:b})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("h4",{className:"font-medium",children:"Verification Method"}),(0,a.jsxs)("button",{onClick:()=>k("email"),className:`w-full p-4 rounded-lg border-2 flex items-center justify-between transition ${"email"===N?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx(o.Z,{className:`w-5 h-5 ${"email"===N?"text-blue-600":"text-gray-400"}`}),(0,a.jsxs)("div",{className:"text-left",children:[a.jsx("p",{className:"font-medium",children:"Email"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Receive codes via email"})]})]}),"email"===N&&a.jsx(c.Z,{className:"w-5 h-5 text-blue-600"})]}),(0,a.jsxs)("button",{onClick:()=>k("sms"),className:`w-full p-4 rounded-lg border-2 flex items-center justify-between transition ${"sms"===N?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"} ${g?.phone?"":"opacity-50 cursor-not-allowed"}`,disabled:!g?.phone,children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx(m.Z,{className:`w-5 h-5 ${"sms"===N?"text-blue-600":"text-gray-400"}`}),(0,a.jsxs)("div",{className:"text-left",children:[a.jsx("p",{className:"font-medium",children:"SMS"}),a.jsx("p",{className:"text-sm text-gray-500",children:g?.phone?`Receive codes via SMS to ${g.phone}`:"Add phone number to enable"})]})]}),"sms"===N&&g?.phone&&a.jsx(c.Z,{className:"w-5 h-5 text-blue-600"})]})]}),(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-100",children:[a.jsx("h4",{className:"font-medium text-blue-800 mb-1",children:"\uD83D\uDD10 Security Tip"}),a.jsx("p",{className:"text-sm text-blue-700",children:"Two-factor authentication helps protect your account even if someone knows your password. We'll send a verification code each time you sign in from a new device."})]})]})]}),S&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)(n.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"bg-white rounded-xl p-6 max-w-md w-full shadow-2xl",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",children:"enable"===P?"Enable 2FA":"Disable 2FA"}),"enable"===P?(0,a.jsxs)(a.Fragment,{children:[a.jsx("p",{className:"text-gray-600 mb-4",children:"Enter the 6-digit code sent to your email to enable two-factor authentication."}),a.jsx("input",{type:"text",placeholder:"Enter 6-digit code",value:Z,onChange:e=>E(e.target.value.replace(/\D/g,"").slice(0,6)),className:"w-full px-4 py-3 border-2 rounded-lg text-center text-2xl tracking-widest font-mono mb-4",maxLength:6})]}):a.jsx("p",{className:"text-gray-600 mb-4",children:"Are you sure you want to disable two-factor authentication? Your account will be less secure."}),(0,a.jsxs)("div",{className:"flex gap-3",children:[a.jsx(x.z,{variant:"outline",className:"flex-1",onClick:()=>{C(!1),E("")},children:"Cancel"}),a.jsx(x.z,{className:"flex-1",onClick:O,disabled:M||"enable"===P&&6!==Z.length,children:M?(0,a.jsxs)(a.Fragment,{children:[a.jsx(l.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):"Confirm"})]})]})})]})})}},33071:(e,t,s)=>{"use strict";s.d(t,{Ol:()=>l,SZ:()=>c,Zb:()=>n,aY:()=>d,ll:()=>o});var a=s(10326),r=s(17577),i=s(77863);let n=r.forwardRef(({className:e,...t},s)=>a.jsx("div",{ref:s,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));n.displayName="Card";let l=r.forwardRef(({className:e,...t},s)=>a.jsx("div",{ref:s,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...t}));l.displayName="CardHeader";let o=r.forwardRef(({className:e,...t},s)=>a.jsx("h3",{ref:s,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));o.displayName="CardTitle";let c=r.forwardRef(({className:e,...t},s)=>a.jsx("p",{ref:s,className:(0,i.cn)("text-sm text-muted-foreground",e),...t}));c.displayName="CardDescription";let d=r.forwardRef(({className:e,...t},s)=>a.jsx("div",{ref:s,className:(0,i.cn)("p-6 pt-0",e),...t}));d.displayName="CardContent",r.forwardRef(({className:e,...t},s)=>a.jsx("div",{ref:s,className:(0,i.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter"},96655:(e,t,s)=>{"use strict";s.d(t,{r:()=>N});var a=s(10326),r=s(17577),i=s(82561),n=s(48051),l=s(93095),o=s(52067),c=s(53405),d=s(2566),u=s(77335),m="Switch",[x,h]=(0,l.b)(m),[p,f]=x(m),b=r.forwardRef((e,t)=>{let{__scopeSwitch:s,name:l,checked:c,defaultChecked:d,required:x,disabled:h,value:f="on",onCheckedChange:b,form:y,...g}=e,[v,N]=r.useState(null),k=(0,n.e)(t,e=>N(e)),S=r.useRef(!1),C=!v||y||!!v.closest("form"),[P,A]=(0,o.T)({prop:c,defaultProp:d??!1,onChange:b,caller:m});return(0,a.jsxs)(p,{scope:s,checked:P,disabled:h,children:[(0,a.jsx)(u.WV.button,{type:"button",role:"switch","aria-checked":P,"aria-required":x,"data-state":w(P),"data-disabled":h?"":void 0,disabled:h,value:f,...g,ref:k,onClick:(0,i.Mj)(e.onClick,e=>{A(e=>!e),C&&(S.current=e.isPropagationStopped(),S.current||e.stopPropagation())})}),C&&(0,a.jsx)(j,{control:v,bubbles:!S.current,name:l,value:f,checked:P,required:x,disabled:h,form:y,style:{transform:"translateX(-100%)"}})]})});b.displayName=m;var y="SwitchThumb",g=r.forwardRef((e,t)=>{let{__scopeSwitch:s,...r}=e,i=f(y,s);return(0,a.jsx)(u.WV.span,{"data-state":w(i.checked),"data-disabled":i.disabled?"":void 0,...r,ref:t})});g.displayName=y;var j=r.forwardRef(({__scopeSwitch:e,control:t,checked:s,bubbles:i=!0,...l},o)=>{let u=r.useRef(null),m=(0,n.e)(u,o),x=(0,c.D)(s),h=(0,d.t)(t);return r.useEffect(()=>{let e=u.current;if(!e)return;let t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(x!==s&&t){let a=new Event("click",{bubbles:i});t.call(e,s),e.dispatchEvent(a)}},[x,s,i]),(0,a.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s,...l,tabIndex:-1,ref:m,style:{...l.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function w(e){return e?"checked":"unchecked"}j.displayName="SwitchBubbleInput";var v=s(77863);let N=r.forwardRef(({className:e,...t},s)=>a.jsx(b,{className:(0,v.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:s,children:a.jsx(g,{className:(0,v.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));N.displayName=b.displayName},77506:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(62881).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},50949:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(62881).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},18512:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(68570).createProxy)(String.raw`C:\Users\samia\Desktop\Learning Journey\HostNin\SilkMartWebSite\app\account\security\page.tsx#default`)},53405:(e,t,s)=>{"use strict";s.d(t,{D:()=>r});var a=s(17577);function r(e){let t=a.useRef({value:e,previous:e});return a.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}},2566:(e,t,s)=>{"use strict";s.d(t,{t:()=>i});var a=s(17577),r=s(65819);function i(e){let[t,s]=a.useState(void 0);return(0,r.b)(()=>{if(e){s({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let a,r;if(!Array.isArray(t)||!t.length)return;let i=t[0];if("borderBoxSize"in i){let e=i.borderBoxSize,t=Array.isArray(e)?e[0]:e;a=t.inlineSize,r=t.blockSize}else a=e.offsetWidth,r=e.offsetHeight;s({width:a,height:r})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}s(void 0)},[e]),t}}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[8948,717,944],()=>s(2848));module.exports=a})();