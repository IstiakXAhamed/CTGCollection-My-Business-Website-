(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8606],{93212:function(e,t,s){Promise.resolve().then(s.bind(s,76665))},76665:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return k}});var a=s(57437),n=s(2265),r=s(27648),i=s(66070),l=s(62869),d=s(95186),c=s(82431),o=s(92735),u=s(73247),m=s(44794),x=s(42208),p=s(40875),f=s(41671),h=s(51817),g=s(89345),y=s(94508),v=s(24895),b=s(26e3);let j={pending:"bg-yellow-100 text-yellow-800",confirmed:"bg-blue-100 text-blue-800",processing:"bg-purple-100 text-purple-800",shipped:"bg-indigo-100 text-indigo-800",delivered:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"},N={pending:"bg-orange-100 text-orange-800",paid:"bg-green-100 text-green-800",failed:"bg-red-100 text-red-800"},w=["pending","confirmed","processing","shipped","delivered","cancelled"];function k(){let[e,t]=(0,n.useState)([]),[s,k]=(0,n.useState)({page:1,limit:20,total:0,totalPages:0}),[C,S]=(0,n.useState)(!0),[Z,z]=(0,n.useState)(""),[P,D]=(0,n.useState)(null),[L,R]=(0,n.useState)(null),[F,M]=(0,n.useState)(null),{toast:E}=(0,v.p)();(0,b.w)((0,n.useCallback)(()=>T(),[s.page,s.limit])),(0,n.useEffect)(()=>{T()},[s.page,s.limit]);let T=async()=>{S(!0);try{let e=new URLSearchParams({page:s.page.toString(),limit:s.limit.toString(),search:Z}),a=await fetch("/api/admin/orders?".concat(e),{credentials:"include"});if(a.ok){let e=await a.json();t(e.orders||[]),e.pagination&&k(t=>({...t,...e.pagination}))}}catch(e){console.error("Failed to fetch orders:",e)}finally{S(!1)}},O=async(s,a)=>{D(s);try{(await fetch("/api/admin/orders/".concat(s),{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({status:a})})).ok&&t(e.map(e=>e.id===s?{...e,status:a}:e))}catch(e){console.error("Failed to update status:",e)}finally{D(null)}},_=async s=>{if(confirm("Confirm payment received? This will generate a receipt and send email to customer.")){R(s);try{let a=await fetch("/api/admin/orders/".concat(s),{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({paymentStatus:"paid",status:"confirmed",sendEmail:!0})}),n=await a.json();a.ok?(t(e.map(e=>e.id===s?{...e,paymentStatus:"paid",status:"confirmed"}:e)),alert(n.message||"Payment confirmed! Receipt sent to customer.")):alert(n.error||"Failed to confirm payment")}catch(e){console.error("Failed to confirm payment:",e),alert("Failed to confirm payment")}finally{R(null)}}},A=async e=>{M(e);try{let t=await fetch("/api/orders/".concat(e,"/receipt"),{method:"POST",credentials:"include"}),s=await t.json();t.ok?E({title:"✅ Receipt Sent!",description:s.message||"Receipt with attachment sent to customer email."}):E({title:"❌ Failed to Send",description:s.error||"Failed to send receipt",variant:"destructive"})}catch(e){E({title:"❌ Error",description:"Failed to send receipt. Please try again.",variant:"destructive"})}finally{M(null)}},q=e.filter(e=>{var t,s;return(e.orderNumber||e.id).toLowerCase().includes(Z.toLowerCase())||((null===(t=e.user)||void 0===t?void 0:t.name)||"").toLowerCase().includes(Z.toLowerCase())||((null===(s=e.user)||void 0===s?void 0:s.email)||e.guestEmail||"").toLowerCase().includes(Z.toLowerCase())});return C?(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsx)(c.Z,{className:"w-8 h-8 animate-spin text-blue-600"})}):(0,a.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl sm:text-2xl lg:text-3xl font-bold mb-1",children:"Orders"}),(0,a.jsxs)("p",{className:"text-xs sm:text-sm text-muted-foreground",children:[e.length," total orders"]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(l.z,{variant:"outline",size:"sm",onClick:()=>window.open("/api/admin/orders/export","_blank"),children:[(0,a.jsx)(o.Z,{className:"w-4 h-4 sm:mr-2"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Export"})]}),(0,a.jsxs)(l.z,{onClick:T,variant:"outline",size:"sm",children:[(0,a.jsx)(c.Z,{className:"w-4 h-4 sm:mr-2"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Refresh"})]})]})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{className:"p-3 sm:p-4",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(u.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 sm:w-5 sm:h-5 text-muted-foreground"}),(0,a.jsx)(d.I,{placeholder:"Search orders...",value:Z,onChange:e=>z(e.target.value),className:"pl-9 sm:pl-10 h-10 text-sm"})]})}),(0,a.jsx)(i.aY,{className:"p-2 sm:p-4",children:0===e.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(m.Z,{className:"w-10 h-10 mx-auto text-muted-foreground mb-3"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"No orders yet"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"lg:hidden space-y-3",children:q.map(e=>{var t;return(0,a.jsxs)("div",{className:"border rounded-lg p-3 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-mono text-xs sm:text-sm font-semibold text-blue-600",children:e.orderNumber||"#".concat(e.id.slice(0,8))}),(0,a.jsx)("span",{className:"px-2 py-0.5 rounded-full text-[10px] sm:text-xs font-semibold ".concat(j[e.status]||"bg-gray-100"),children:e.status})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs sm:text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground truncate max-w-[120px]",children:(null===(t=e.user)||void 0===t?void 0:t.name)||"Guest"}),(0,a.jsx)("span",{className:"font-semibold",children:(0,y.T4)(e.total)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"px-1.5 py-0.5 rounded text-[10px] ".concat(N[e.paymentStatus]||"bg-gray-100"),children:"paid"===e.paymentStatus?"Paid":"Pending"}),(0,a.jsx)("span",{className:"text-[10px] text-muted-foreground",children:new Date(e.createdAt).toLocaleDateString()})]}),(0,a.jsx)(r.default,{href:"/admin/orders/".concat(e.id),children:(0,a.jsxs)(l.z,{size:"sm",variant:"outline",className:"h-7 text-xs px-2",children:[(0,a.jsx)(x.Z,{className:"w-3 h-3 mr-1"})," View"]})})]})]},e.id)})}),(0,a.jsx)("div",{className:"hidden lg:block overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b",children:[(0,a.jsx)("th",{className:"text-left py-3 px-4",children:"Order #"}),(0,a.jsx)("th",{className:"text-left py-3 px-4",children:"Customer"}),(0,a.jsx)("th",{className:"text-left py-3 px-4",children:"Total"}),(0,a.jsx)("th",{className:"text-left py-3 px-4",children:"Payment"}),(0,a.jsx)("th",{className:"text-left py-3 px-4",children:"Status"}),(0,a.jsx)("th",{className:"text-left py-3 px-4",children:"Date"}),(0,a.jsx)("th",{className:"text-right py-3 px-4",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:q.map(e=>{var t,s,n;return(0,a.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,a.jsxs)("td",{className:"py-4 px-4",children:[(0,a.jsx)("span",{className:"font-mono font-semibold text-blue-600",children:e.orderNumber||"#".concat(e.id.slice(0,8))}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-0.5",children:"cod"===e.paymentMethod?"\uD83D\uDCB5 COD":"\uD83D\uDCB3 Online"})]}),(0,a.jsx)("td",{className:"py-4 px-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:(null===(t=e.user)||void 0===t?void 0:t.name)||(null===(s=e.address)||void 0===s?void 0:s.name)||"Guest"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:(null===(n=e.user)||void 0===n?void 0:n.email)||e.guestEmail||"-"})]})}),(0,a.jsx)("td",{className:"py-4 px-4",children:(0,a.jsx)("span",{className:"font-semibold",children:(0,y.T4)(e.total)})}),(0,a.jsx)("td",{className:"py-4 px-4",children:(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-semibold ".concat(N[e.paymentStatus]||"bg-gray-100"),children:"paid"===e.paymentStatus?"✓ Paid":"failed"===e.paymentStatus?"✗ Failed":"⏳ Pending"})}),(0,a.jsx)("td",{className:"py-4 px-4",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("select",{value:e.status,onChange:t=>O(e.id,t.target.value),disabled:P===e.id,className:"appearance-none px-3 py-1 pr-8 rounded-full text-xs font-semibold cursor-pointer ".concat(j[e.status]||"bg-gray-100"),children:w.map(e=>(0,a.jsx)("option",{value:e,children:e},e))}),(0,a.jsx)(p.Z,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-3 h-3 pointer-events-none"})]})}),(0,a.jsx)("td",{className:"py-4 px-4",children:(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:new Date(e.createdAt).toLocaleDateString()})}),(0,a.jsx)("td",{className:"py-4 px-4",children:(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:["paid"!==e.paymentStatus&&(0,a.jsx)(l.z,{size:"sm",variant:"outline",className:"text-green-600 border-green-200 hover:bg-green-50",onClick:()=>_(e.id),disabled:L===e.id,children:L===e.id?(0,a.jsx)(c.Z,{className:"w-4 h-4 animate-spin"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.Z,{className:"w-4 h-4 mr-1"}),"Confirm Pay"]})}),"paid"===e.paymentStatus&&(0,a.jsx)(l.z,{size:"sm",variant:"outline",className:"text-blue-600",onClick:()=>A(e.id),disabled:F===e.id,children:F===e.id?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.Z,{className:"w-4 h-4 mr-1 animate-spin"}),"Sending..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.Z,{className:"w-4 h-4 mr-1"}),"Receipt"]})}),(0,a.jsx)(r.default,{href:"/admin/orders/".concat(e.id),children:(0,a.jsxs)(l.z,{size:"sm",variant:"outline",children:[(0,a.jsx)(x.Z,{className:"w-4 h-4 mr-1"}),"View"]})})]})})]},e.id)})})]})})]})})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 mt-4 pb-8",children:[(0,a.jsxs)("div",{className:"text-xs sm:text-sm text-gray-500 text-center sm:text-left",children:["Showing ",(s.page-1)*s.limit+1,"-",Math.min(s.page*s.limit,s.total)," of ",s.total]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>k(e=>({...e,page:Math.max(1,e.page-1)})),disabled:s.page<=1||C,children:"Prev"}),(0,a.jsxs)("span",{className:"text-xs sm:text-sm font-medium flex items-center px-2",children:[s.page,"/",s.totalPages||1]}),(0,a.jsx)(l.z,{variant:"outline",size:"sm",onClick:()=>k(e=>({...e,page:Math.min(e.totalPages||1,e.page+1)})),disabled:s.page>=(s.totalPages||1)||C,children:"Next"})]})]})]})}},62869:function(e,t,s){"use strict";s.d(t,{d:function(){return d},z:function(){return c}});var a=s(57437),n=s(2265),r=s(37053),i=s(90535),l=s(94508);let d=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-md hover:shadow-lg",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=n.forwardRef((e,t)=>{let{className:s,variant:n,size:i,asChild:c=!1,...o}=e,u=c?r.g7:"button";return(0,a.jsx)(u,{className:(0,l.cn)(d({variant:n,size:i,className:s})),ref:t,...o})});c.displayName="Button"},66070:function(e,t,s){"use strict";s.d(t,{Ol:function(){return l},SZ:function(){return c},Zb:function(){return i},aY:function(){return o},ll:function(){return d}});var a=s(57437),n=s(2265),r=s(94508);let i=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...n})});i.displayName="Card";let l=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",s),...n})});l.displayName="CardHeader";let d=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("h3",{ref:t,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",s),...n})});d.displayName="CardTitle";let c=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("p",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",s),...n})});c.displayName="CardDescription";let o=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",s),...n})});o.displayName="CardContent",n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",s),...n})}).displayName="CardFooter"},95186:function(e,t,s){"use strict";s.d(t,{I:function(){return i}});var a=s(57437),n=s(2265),r=s(94508);let i=n.forwardRef((e,t)=>{let{className:s,type:n,...i}=e;return(0,a.jsx)("input",{type:n,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...i})});i.displayName="Input"},24895:function(e,t,s){"use strict";s.d(t,{V:function(){return i},p:function(){return d}});var a=s(57437),n=s(2265);let r=n.createContext(void 0);function i(e){let{children:t}=e,[s,i]=n.useState([]),d=n.useCallback(e=>{let t=Math.random().toString(36).substring(2,9),s={...e,id:t};i(e=>[...e,s]),setTimeout(()=>{i(e=>e.filter(e=>e.id!==t))},e.duration||4e3)},[]),c=n.useCallback(e=>{i(t=>t.filter(t=>t.id!==e))},[]);return(0,a.jsxs)(r.Provider,{value:{toasts:s,toast:d,dismiss:c},children:[t,(0,a.jsx)(l,{toasts:s,dismiss:c})]})}function l(e){let{toasts:t,dismiss:s}=e;return 0===t.length?null:(0,a.jsx)("div",{className:"fixed bottom-4 right-4 z-50 flex flex-col gap-2 max-w-md",children:t.map(e=>{var t;return(0,a.jsxs)("div",{className:"p-4 rounded-lg shadow-lg transform transition-all duration-300 ".concat(null!==(t=e.className)&&void 0!==t?t:"destructive"===e.variant?"bg-red-500 text-white":"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700"),onClick:()=>s(e.id),children:[e.title&&(0,a.jsx)("p",{className:"font-semibold ".concat("destructive"===e.variant?"text-white":"text-gray-900 dark:text-white"),children:e.title}),e.description&&(0,a.jsx)("p",{className:"text-sm ".concat("destructive"===e.variant?"text-white/90":"text-gray-600 dark:text-gray-300"),children:e.description})]},e.id)})})}function d(){let e=n.useContext(r);if(!e)throw Error("useToast must be used within a ToastProvider");return e}},26e3:function(e,t,s){"use strict";s.d(t,{w:function(){return n}});var a=s(2265);function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{interval:s=3e4,refreshOnFocus:n=!0,enabled:r=!0}=t,i=(0,a.useRef)(e),l=(0,a.useRef)(null);(0,a.useEffect)(()=>{i.current=e},[e]);let d=(0,a.useCallback)(()=>{"visible"===document.visibilityState&&n&&r&&i.current()},[n,r]);return(0,a.useEffect)(()=>{if(r)return l.current=setInterval(()=>{i.current()},s),n&&document.addEventListener("visibilitychange",d),()=>{l.current&&clearInterval(l.current),n&&document.removeEventListener("visibilitychange",d)}},[s,n,r,d]),{refresh:(0,a.useCallback)(()=>{i.current()},[])}}},94508:function(e,t,s){"use strict";s.d(t,{T4:function(){return i},cn:function(){return r}});var a=s(61994),n=s(53335);function r(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,n.m6)((0,a.W)(t))}function i(e){return new Intl.NumberFormat("en-BD",{style:"currency",currency:"BDT",minimumFractionDigits:0}).format(e)}},40875:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(79205).Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},41671:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(79205).Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},92735:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(79205).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},42208:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(79205).Z)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},51817:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(79205).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},89345:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(79205).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},44794:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(79205).Z)("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},82431:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(79205).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},73247:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(79205).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])}},function(e){e.O(0,[8590,5650,2971,2117,1744],function(){return e(e.s=93212)}),_N_E=e.O()}]);