(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9458],{27637:function(e,t,n){Promise.resolve().then(n.bind(n,89602))},89602:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return k}});var a=n(57437),s=n(2265),l=n(48614),i=n(36891),r=n(33245),c=n(49322),o=n(41671),d=n(62720),u=n(82431),m=n(32489),x=n(83229),f=n(56439),p=n(99397),h=n(95805),g=n(31047),v=n(88893),y=n(18930),j=n(66070),b=n(62869),N=n(95186),w=n(26815);let C=[{value:"info",label:"Info",color:"bg-blue-100 text-blue-800",icon:r.Z},{value:"warning",label:"Warning",color:"bg-yellow-100 text-yellow-800",icon:c.Z},{value:"success",label:"Success",color:"bg-green-100 text-green-800",icon:o.Z},{value:"promo",label:"Promo",color:"bg-purple-100 text-purple-800",icon:d.Z}],D=[{value:"all",label:"All Users"},{value:"customers",label:"Customers Only"},{value:"admins",label:"Admins Only"}];function k(){let[e,t]=(0,s.useState)([]),[n,r]=(0,s.useState)(!0),[c,o]=(0,s.useState)(!1),[d,k]=(0,s.useState)(null),[S,A]=(0,s.useState)(!1),[Z,_]=(0,s.useState)({title:"",content:"",type:"info",priority:0,targetAudience:"all",startDate:new Date().toISOString().slice(0,16),endDate:""});(0,s.useEffect)(()=>{z()},[]);let z=async()=>{try{let e=await fetch("/api/admin/announcements",{credentials:"include"});if(e.ok){let n=await e.json();t(n.announcements||[])}}catch(e){console.error("Failed to fetch announcements:",e)}finally{r(!1)}},I=()=>{_({title:"",content:"",type:"info",priority:0,targetAudience:"all",startDate:new Date().toISOString().slice(0,16),endDate:""}),k(null),o(!1)},O=e=>{_({title:e.title,content:e.content,type:e.type,priority:e.priority,targetAudience:e.targetAudience,startDate:new Date(e.startDate).toISOString().slice(0,16),endDate:e.endDate?new Date(e.endDate).toISOString().slice(0,16):""}),k(e.id),o(!0)},T=async()=>{if(!Z.title||!Z.content){alert("Title and content are required");return}A(!0);try{let e=d?{id:d,...Z}:Z,t=await fetch("/api/admin/announcements",{method:d?"PUT":"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(t.ok)I(),await z();else{let e=await t.json();alert(e.error||"Failed to save")}}catch(e){alert("Failed to save announcement")}finally{A(!1)}},E=async e=>{if(confirm("Delete this announcement?"))try{(await fetch("/api/admin/announcements?id=".concat(e),{method:"DELETE",credentials:"include"})).ok&&await z()}catch(e){alert("Failed to delete")}},F=async e=>{try{await fetch("/api/admin/announcements",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({id:e.id,isActive:!e.isActive})}),await z()}catch(e){console.error("Failed to toggle:",e)}};return n?(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsx)(u.Z,{className:"w-8 h-8 animate-spin text-blue-600"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(l.M,{children:c&&(0,a.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>I(),children:(0,a.jsxs)(i.E.div,{initial:{scale:.9},animate:{scale:1},exit:{scale:.9},className:"bg-white rounded-2xl p-6 max-w-lg w-full max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold",children:[d?"Edit":"New"," Announcement"]}),(0,a.jsx)("button",{onClick:()=>I(),className:"p-2 hover:bg-gray-100 rounded-full",children:(0,a.jsx)(m.Z,{className:"w-5 h-5"})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w._,{children:"Title"}),(0,a.jsx)(N.I,{value:Z.title,onChange:e=>_({...Z,title:e.target.value}),placeholder:"Important Update"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w._,{children:"Content"}),(0,a.jsx)("textarea",{value:Z.content,onChange:e=>_({...Z,content:e.target.value}),className:"w-full px-3 py-2 border rounded-lg min-h-[100px]",placeholder:"Announcement details..."})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w._,{children:"Type"}),(0,a.jsx)("select",{value:Z.type,onChange:e=>_({...Z,type:e.target.value}),className:"w-full px-3 py-2 border rounded-lg",children:C.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w._,{children:"Priority"}),(0,a.jsx)(N.I,{type:"number",value:Z.priority,onChange:e=>_({...Z,priority:parseInt(e.target.value)||0})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w._,{children:"Target Audience"}),(0,a.jsx)("select",{value:Z.targetAudience,onChange:e=>_({...Z,targetAudience:e.target.value}),className:"w-full px-3 py-2 border rounded-lg",children:D.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(w._,{children:"Start Date"}),(0,a.jsx)(N.I,{type:"datetime-local",value:Z.startDate,onChange:e=>_({...Z,startDate:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w._,{children:"End Date (Optional)"}),(0,a.jsx)(N.I,{type:"datetime-local",value:Z.endDate,onChange:e=>_({...Z,endDate:e.target.value})})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,a.jsx)(b.z,{variant:"outline",onClick:()=>I(),className:"flex-1",children:"Cancel"}),(0,a.jsxs)(b.z,{onClick:T,disabled:S,className:"flex-1",children:[(0,a.jsx)(x.Z,{className:"w-4 h-4 mr-2"}),S?"Saving...":"Save"]})]})]})})}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold flex items-center gap-3",children:[(0,a.jsx)(f.Z,{className:"w-8 h-8 text-blue-600"}),"Announcements"]}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Create announcements that show once per user login"})]}),(0,a.jsxs)(b.z,{onClick:()=>o(!0),className:"gap-2",children:[(0,a.jsx)(p.Z,{className:"w-4 h-4"}),"New Announcement"]})]}),0===e.length?(0,a.jsxs)(j.Zb,{className:"text-center py-12",children:[(0,a.jsx)(f.Z,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"No announcements yet"}),(0,a.jsx)(b.z,{onClick:()=>o(!0),children:"Create First Announcement"})]}):(0,a.jsx)("div",{className:"space-y-4",children:e.map(e=>{var t,n;let s=C.find(t=>t.value===e.type)||C[0],l=s.icon;return(0,a.jsx)(j.Zb,{className:"".concat(e.isActive?"":"opacity-60"),children:(0,a.jsx)(j.aY,{className:"p-5",children:(0,a.jsxs)("div",{className:"flex flex-col items-start gap-4 md:flex-row md:justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsxs)("span",{className:"px-2 py-1 rounded-full text-xs font-semibold flex items-center gap-1 ".concat(s.color),children:[(0,a.jsx)(l,{className:"w-3 h-3"}),s.label]}),(0,a.jsxs)("span",{className:"text-xs text-gray-500 flex items-center gap-1",children:[(0,a.jsx)(h.Z,{className:"w-3 h-3"}),null===(t=D.find(t=>t.value===e.targetAudience))||void 0===t?void 0:t.label]}),(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["Priority: ",e.priority]})]}),(0,a.jsx)("h3",{className:"font-bold text-lg",children:e.title}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:e.content}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mt-3 text-xs text-gray-500",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(g.Z,{className:"w-3 h-3"}),new Date(e.startDate).toLocaleDateString(),e.endDate&&" - ".concat(new Date(e.endDate).toLocaleDateString())]}),(0,a.jsxs)("span",{children:[(null===(n=e._count)||void 0===n?void 0:n.dismissals)||0," dismissed"]})]})]}),(0,a.jsxs)("div",{className:"flex w-full flex-row gap-2 md:w-auto md:flex-col",children:[(0,a.jsx)(b.z,{size:"sm",variant:e.isActive?"default":"outline",onClick:()=>F(e),children:e.isActive?"Active":"Inactive"}),(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)(b.z,{size:"sm",variant:"outline",onClick:()=>O(e),children:(0,a.jsx)(v.Z,{className:"w-4 h-4"})}),(0,a.jsx)(b.z,{size:"sm",variant:"outline",className:"text-red-600",onClick:()=>E(e.id),children:(0,a.jsx)(y.Z,{className:"w-4 h-4"})})]})]})]})})},e.id)})})]})}},62869:function(e,t,n){"use strict";n.d(t,{d:function(){return c},z:function(){return o}});var a=n(57437),s=n(2265),l=n(37053),i=n(90535),r=n(94508);let c=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-md hover:shadow-lg",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=s.forwardRef((e,t)=>{let{className:n,variant:s,size:i,asChild:o=!1,...d}=e,u=o?l.g7:"button";return(0,a.jsx)(u,{className:(0,r.cn)(c({variant:s,size:i,className:n})),ref:t,...d})});o.displayName="Button"},66070:function(e,t,n){"use strict";n.d(t,{Ol:function(){return r},SZ:function(){return o},Zb:function(){return i},aY:function(){return d},ll:function(){return c}});var a=n(57437),s=n(2265),l=n(94508);let i=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",n),...s})});i.displayName="Card";let r=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",n),...s})});r.displayName="CardHeader";let c=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("h3",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",n),...s})});c.displayName="CardTitle";let o=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("p",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",n),...s})});o.displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",n),...s})});d.displayName="CardContent",s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",n),...s})}).displayName="CardFooter"},95186:function(e,t,n){"use strict";n.d(t,{I:function(){return i}});var a=n(57437),s=n(2265),l=n(94508);let i=s.forwardRef((e,t)=>{let{className:n,type:s,...i}=e;return(0,a.jsx)("input",{type:s,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),ref:t,...i})});i.displayName="Input"},26815:function(e,t,n){"use strict";n.d(t,{_:function(){return o}});var a=n(57437),s=n(2265),l=n(370),i=n(90535),r=n(94508);let c=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)(l.f,{ref:t,className:(0,r.cn)(c(),n),...s})});o.displayName=l.f.displayName},94508:function(e,t,n){"use strict";n.d(t,{T4:function(){return i},cn:function(){return l}});var a=n(61994),s=n(53335);function l(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,s.m6)((0,a.W)(t))}function i(e){return new Intl.NumberFormat("en-BD",{style:"currency",currency:"BDT",minimumFractionDigits:0}).format(e)}}},function(e){e.O(0,[8590,6891,7995,2971,2117,1744],function(){return e(e.s=27637)}),_N_E=e.O()}]);