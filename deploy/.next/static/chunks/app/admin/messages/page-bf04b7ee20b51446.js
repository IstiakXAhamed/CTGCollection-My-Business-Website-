(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3439],{33132:function(e,s,t){Promise.resolve().then(t.bind(t,29364))},29364:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return C}});var a=t(57437),r=t(2265),i=t(82431),n=t(89345),l=t(73247),c=t(40519),d=t(41671),o=t(87769),m=t(42208),u=t(38098),x=t(18930),p=t(91723),f=t(53417),h=t(32489),g=t(51817),j=t(44743),b=t(66070),y=t(62869),N=t(95186),v=t(76818),w=t(26815),S=t(36891),R=t(48614),T=t(35153);function C(){let{toast:e}=(0,T.pm)(),[s,t]=(0,r.useState)([]),[C,k]=(0,r.useState)(null),[D,E]=(0,r.useState)(!0),[Z,_]=(0,r.useState)(""),[O,A]=(0,r.useState)("all"),[z,I]=(0,r.useState)(null),[M,F]=(0,r.useState)(!1),[L,P]=(0,r.useState)(""),[Y,U]=(0,r.useState)(""),[V,B]=(0,r.useState)(!1);(0,r.useEffect)(()=>{J()},[]);let J=async()=>{E(!0);try{let e=await fetch("/api/admin/messages",{credentials:"include"});if(e.ok){let s=await e.json();t(s.messages||[]),k(s.stats)}}catch(e){console.error("Failed to fetch messages:",e)}finally{E(!1)}},G=async(e,s)=>{try{await fetch("/api/admin/messages",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({id:e,isRead:s})}),t(t=>t.map(t=>t.id===e?{...t,isRead:s}:t)),(null==z?void 0:z.id)===e&&I({...z,isRead:s})}catch(e){console.error("Failed to update:",e)}},H=async e=>{if(confirm("Delete this message?"))try{await fetch("/api/admin/messages?id=".concat(e),{method:"DELETE",credentials:"include"}),t(s=>s.filter(s=>s.id!==e)),(null==z?void 0:z.id)===e&&I(null)}catch(e){console.error("Failed to delete:",e)}},W=async()=>{if(z&&Y.trim()){B(!0);try{let s=await fetch("/api/admin/messages/reply",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({messageId:z.id,replySubject:L,replyContent:Y})}),a=await s.json();s.ok?(e({title:"Reply sent!",description:a.emailSent?"Email sent and message marked as replied.":"Message marked as replied. (Email could not be sent - check SMTP settings)"}),t(e=>e.map(e=>e.id===z.id?{...e,isReplied:!0,isRead:!0}:e)),I({...z,isReplied:!0,isRead:!0}),F(!1)):e({title:"Error",description:a.error,variant:"destructive"})}catch(s){e({title:"Error",description:"Failed to send reply",variant:"destructive"})}finally{B(!1)}}},X=s.filter(e=>{if("unread"===O&&e.isRead||"replied"===O&&!e.isReplied)return!1;if(Z){let s=Z.toLowerCase();return e.name.toLowerCase().includes(s)||e.email.toLowerCase().includes(s)||e.subject.toLowerCase().includes(s)}return!0});return D?(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsx)(i.Z,{className:"w-8 h-8 animate-spin text-blue-600"})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold flex items-center gap-3",children:[(0,a.jsx)(n.Z,{className:"w-8 h-8 text-blue-600"}),"Contact Messages"]}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"View and manage messages from contact form"})]}),(0,a.jsxs)(y.z,{variant:"outline",onClick:J,children:[(0,a.jsx)(i.Z,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),C&&(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsx)(b.Zb,{children:(0,a.jsxs)(b.aY,{className:"p-4 text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:C.total}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Total"})]})}),(0,a.jsx)(b.Zb,{children:(0,a.jsxs)(b.aY,{className:"p-4 text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:C.unread}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Unread"})]})}),(0,a.jsx)(b.Zb,{children:(0,a.jsxs)(b.aY,{className:"p-4 text-center",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-green-600",children:C.replied}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Replied"})]})})]}),(0,a.jsx)(b.Zb,{children:(0,a.jsxs)(b.aY,{className:"p-4 flex flex-wrap gap-4 items-center",children:[(0,a.jsxs)("div",{className:"relative flex-1 min-w-[200px]",children:[(0,a.jsx)(l.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,a.jsx)(N.I,{value:Z,onChange:e=>_(e.target.value),placeholder:"Search by name, email, subject...",className:"pl-10"})]}),(0,a.jsx)("div",{className:"flex gap-2",children:["all","unread","replied"].map(e=>(0,a.jsx)(y.z,{size:"sm",variant:O===e?"default":"outline",onClick:()=>A(e),children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]})}),(0,a.jsxs)("div",{className:"grid lg:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-1 space-y-2 max-h-[600px] overflow-y-auto",children:0===X.length?(0,a.jsxs)(b.Zb,{className:"text-center py-12",children:[(0,a.jsx)(n.Z,{className:"w-12 h-12 mx-auto text-gray-300 mb-4"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No messages"})]}):X.map(e=>(0,a.jsxs)(S.E.div,{initial:{opacity:0},animate:{opacity:1},onClick:()=>{I(e),e.isRead||G(e.id,!0)},className:"p-4 rounded-lg border cursor-pointer transition hover:shadow-md ".concat((null==z?void 0:z.id)===e.id?"border-blue-500 bg-blue-50":"bg-white"," ").concat(e.isRead?"":"border-l-4 border-l-blue-500"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[e.isRead?e.isReplied?(0,a.jsx)(d.Z,{className:"w-3 h-3 text-green-500"}):(0,a.jsx)(d.Z,{className:"w-3 h-3 text-gray-400"}):(0,a.jsx)(c.Z,{className:"w-3 h-3 fill-blue-500 text-blue-500"}),(0,a.jsx)("span",{className:"font-semibold truncate",children:e.name}),e.isReplied&&(0,a.jsx)("span",{className:"text-xs bg-green-100 text-green-700 px-1.5 py-0.5 rounded",children:"Replied"})]}),(0,a.jsx)("p",{className:"text-sm font-medium truncate",children:e.subject}),(0,a.jsx)("p",{className:"text-xs text-gray-500 truncate",children:e.email}),(0,a.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:new Date(e.createdAt).toLocaleDateString()})]},e.id))}),(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsx)(R.M,{mode:"wait",children:z?(0,a.jsx)(S.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},children:(0,a.jsxs)(b.Zb,{children:[(0,a.jsxs)(b.Ol,{className:"flex flex-row items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:z.subject}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["From: ",z.name," (",z.email,")"]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(y.z,{size:"sm",variant:"outline",onClick:()=>G(z.id,!z.isRead),children:z.isRead?(0,a.jsx)(o.Z,{className:"w-4 h-4"}):(0,a.jsx)(m.Z,{className:"w-4 h-4"})}),(0,a.jsxs)(y.z,{size:"sm",onClick:()=>{z&&(P("Re: ".concat(z.subject)),U(""),F(!0))},disabled:z.isReplied,className:"gap-1",children:[(0,a.jsx)(u.Z,{className:"w-4 h-4"}),z.isReplied?"Replied":"Reply"]}),(0,a.jsx)(y.z,{size:"sm",variant:"outline",className:"text-red-600",onClick:()=>H(z.id),children:(0,a.jsx)(x.Z,{className:"w-4 h-4"})})]})]}),(0,a.jsxs)(b.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 text-sm text-gray-500",children:[z.phone&&(0,a.jsxs)("span",{className:"flex items-center gap-1",children:["\uD83D\uDCDE ",z.phone]}),(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(p.Z,{className:"w-4 h-4"}),new Date(z.createdAt).toLocaleString()]})]}),(0,a.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,a.jsx)("p",{className:"whitespace-pre-wrap",children:z.message})}),z.adminNotes&&(0,a.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-green-700 mb-1",children:"Admin Notes:"}),(0,a.jsx)("p",{className:"text-sm text-green-600",children:z.adminNotes})]})]})]})},z.id):(0,a.jsx)(b.Zb,{className:"h-full flex items-center justify-center py-20",children:(0,a.jsxs)("div",{className:"text-center text-gray-500",children:[(0,a.jsx)(f.Z,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),(0,a.jsx)("p",{children:"Select a message to view details"})]})})})})]}),(0,a.jsx)(R.M,{children:M&&z&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-40",onClick:()=>F(!1)}),(0,a.jsxs)(S.E.div,{initial:{opacity:0,scale:.95,y:-20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-20},className:"fixed left-4 right-4 top-[10%] md:left-1/2 md:right-auto md:-translate-x-1/2 md:w-full md:max-w-2xl bg-white rounded-xl shadow-2xl z-50 overflow-hidden max-h-[80vh]",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b bg-gray-50",children:[(0,a.jsxs)("h3",{className:"text-lg font-bold",children:["Reply to ",z.name]}),(0,a.jsx)("button",{onClick:()=>F(!1),className:"p-1 hover:bg-gray-200 rounded",children:(0,a.jsx)(h.Z,{className:"w-5 h-5"})})]}),(0,a.jsxs)("div",{className:"p-6 space-y-4 max-h-[60vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3 text-sm",children:[(0,a.jsx)("p",{className:"font-semibold",children:"Original message:"}),(0,a.jsxs)("p",{className:"text-gray-600",children:[z.message.substring(0,200),"..."]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w._,{children:"Subject"}),(0,a.jsx)(N.I,{value:L,onChange:e=>P(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(w._,{children:"Reply Message *"}),(0,a.jsx)(v.g,{value:Y,onChange:e=>U(e.target.value),rows:8,placeholder:"Type your reply here...",className:"resize-none"})]}),(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 text-sm",children:[(0,a.jsxs)("p",{className:"text-blue-700",children:["\uD83D\uDCE7 This reply will be sent via email to ",(0,a.jsx)("strong",{children:z.email})]}),(0,a.jsx)("p",{className:"text-blue-600 mt-1",children:"\uD83D\uDD14 If they're a registered user, they'll also get a website notification"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 p-4 border-t bg-gray-50",children:[(0,a.jsx)(y.z,{variant:"outline",onClick:()=>F(!1),children:"Cancel"}),(0,a.jsx)(y.z,{onClick:W,disabled:V||!Y.trim(),children:V?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Sending..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.Z,{className:"w-4 h-4 mr-2"}),"Send Reply"]})})]})]})]})})]})}},62869:function(e,s,t){"use strict";t.d(s,{d:function(){return c},z:function(){return d}});var a=t(57437),r=t(2265),i=t(37053),n=t(90535),l=t(94508);let c=(0,n.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-md hover:shadow-lg",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,s)=>{let{className:t,variant:r,size:n,asChild:d=!1,...o}=e,m=d?i.g7:"button";return(0,a.jsx)(m,{className:(0,l.cn)(c({variant:r,size:n,className:t})),ref:s,...o})});d.displayName="Button"},66070:function(e,s,t){"use strict";t.d(s,{Ol:function(){return l},SZ:function(){return d},Zb:function(){return n},aY:function(){return o},ll:function(){return c}});var a=t(57437),r=t(2265),i=t(94508);let n=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...r})});n.displayName="Card";let l=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",t),...r})});l.displayName="CardHeader";let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("h3",{ref:s,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",t),...r})});c.displayName="CardTitle";let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("p",{ref:s,className:(0,i.cn)("text-sm text-muted-foreground",t),...r})});d.displayName="CardDescription";let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,i.cn)("p-6 pt-0",t),...r})});o.displayName="CardContent",r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,i.cn)("flex items-center p-6 pt-0",t),...r})}).displayName="CardFooter"},95186:function(e,s,t){"use strict";t.d(s,{I:function(){return n}});var a=t(57437),r=t(2265),i=t(94508);let n=r.forwardRef((e,s)=>{let{className:t,type:r,...n}=e;return(0,a.jsx)("input",{type:r,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...n})});n.displayName="Input"},26815:function(e,s,t){"use strict";t.d(s,{_:function(){return d}});var a=t(57437),r=t(2265),i=t(370),n=t(90535),l=t(94508);let c=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(i.f,{ref:s,className:(0,l.cn)(c(),t),...r})});d.displayName=i.f.displayName},76818:function(e,s,t){"use strict";t.d(s,{g:function(){return n}});var a=t(57437),r=t(2265),i=t(94508);let n=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...r})});n.displayName="Textarea"},35153:function(e,s,t){"use strict";t.d(s,{pm:function(){return u}});var a=t(2265);let r=0,i=new Map,n=e=>{if(i.has(e))return;let s=setTimeout(()=>{i.delete(e),o({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,s)},l=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=s;return t?n(t):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},c=[],d={toasts:[]};function o(e){d=l(d,e),c.forEach(e=>{e(d)})}function m(e){let{...s}=e,t=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>o({type:"DISMISS_TOAST",toastId:t});return o({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:e=>{e||a()}}}),{id:t,dismiss:a,update:e=>o({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function u(){let[e,s]=a.useState(d);return a.useEffect(()=>(c.push(s),()=>{let e=c.indexOf(s);e>-1&&c.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>o({type:"DISMISS_TOAST",toastId:e})}}},94508:function(e,s,t){"use strict";t.d(s,{T4:function(){return n},cn:function(){return i}});var a=t(61994),r=t(53335);function i(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,r.m6)((0,a.W)(s))}function n(e){return new Intl.NumberFormat("en-BD",{style:"currency",currency:"BDT",minimumFractionDigits:0}).format(e)}}},function(e){e.O(0,[8590,6891,7049,2971,2117,1744],function(){return e(e.s=33132)}),_N_E=e.O()}]);