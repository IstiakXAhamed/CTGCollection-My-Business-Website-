(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9435],{78633:function(e,t,s){Promise.resolve().then(s.bind(s,63612))},63612:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return j}});var r=s(57437),a=s(2265),i=s(99376),n=s(66070),c=s(62869),l=s(95186),o=s(26815),d=s(76818),u=s(51817),p=s(32660),m=s(32489),h=s(17689),f=s(99397),x=s(27648),g=s(33145),v=s(35153);function j(){let e=(0,i.useRouter)(),t=(0,i.useParams)().id,{toast:s}=(0,v.pm)(),[j,b]=(0,a.useState)(!1),[y,N]=(0,a.useState)(!0),[w,k]=(0,a.useState)([]),[P,S]=(0,a.useState)({name:"",slug:"",description:"",categoryId:"",basePrice:"",salePrice:"",isFeatured:!1,isBestseller:!1,isActive:!0}),[C,T]=(0,a.useState)([]),[I,_]=(0,a.useState)([]);(0,a.useEffect)(()=>{A(),F()},[t]);let A=async()=>{try{let e=await fetch("/api/categories");if(e.ok){let t=await e.json();k(t.categories||[])}}catch(e){console.error("Failed to fetch categories:",e)}},F=async()=>{try{let i=await fetch("/api/admin/products/".concat(t),{credentials:"include"});if(i.ok){var r,a;let e=(await i.json()).product;S({name:e.name||"",slug:e.slug||"",description:e.description||"",categoryId:e.categoryId||"",basePrice:(null===(r=e.basePrice)||void 0===r?void 0:r.toString())||"",salePrice:(null===(a=e.salePrice)||void 0===a?void 0:a.toString())||"",isFeatured:e.isFeatured||!1,isBestseller:e.isBestseller||!1,isActive:!1!==e.isActive});let t=[];if(e.images)try{t="string"==typeof e.images?JSON.parse(e.images):e.images}catch(e){t=[]}T(t),_(e.variants||[{size:"M",color:"Default",stock:0,sku:""}])}else s({title:"Error",description:"Failed to load product",variant:"destructive"}),e.push("/admin/products")}catch(e){console.error("Failed to fetch product:",e),s({title:"Error",description:"An error occurred while loading the product",variant:"destructive"})}finally{N(!1)}},Z=e=>{T(t=>t.filter((t,s)=>s!==e))},D=(e,t,s)=>{_(r=>r.map((r,a)=>a===e?{...r,[t]:s}:r))},O=e=>{I.length>1&&_(t=>t.filter((t,s)=>s!==e))},z=async r=>{r.preventDefault(),b(!0);try{let r={...P,basePrice:parseFloat(P.basePrice),salePrice:P.salePrice?parseFloat(P.salePrice):null,images:C,variants:I.map(e=>({size:e.size,color:e.color,stock:parseInt(e.stock.toString()),sku:e.sku||""}))},a=await fetch("/api/admin/products/".concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r),credentials:"include"});if(a.ok)s({title:"Success!",description:"Product updated successfully"}),e.push("/admin/products");else{let e=await a.json();s({title:"Error",description:e.error||"Failed to update product",variant:"destructive"})}}catch(e){console.error("Failed to update product:",e),s({title:"Error",description:"An error occurred while updating the product",variant:"destructive"})}finally{b(!1)}};return y?(0,r.jsxs)("div",{className:"flex items-center justify-center min-h-[400px]",children:[(0,r.jsx)(u.Z,{className:"w-8 h-8 animate-spin text-blue-600"}),(0,r.jsx)("span",{className:"ml-2",children:"Loading product..."})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)(x.default,{href:"/admin/products",children:(0,r.jsx)(c.z,{variant:"ghost",size:"icon",children:(0,r.jsx)(p.Z,{className:"w-5 h-5"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold",children:"Edit Product"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Update product information"})]})]}),(0,r.jsxs)("form",{onSubmit:z,className:"space-y-6",children:[(0,r.jsxs)(n.Zb,{children:[(0,r.jsx)(n.Ol,{children:(0,r.jsx)(n.ll,{children:"Basic Information"})}),(0,r.jsxs)(n.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(o._,{htmlFor:"name",children:"Product Name *"}),(0,r.jsx)(l.I,{id:"name",value:P.name,onChange:e=>S(t=>({...t,name:e.target.value})),placeholder:"e.g., Premium Cotton T-Shirt",required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(o._,{htmlFor:"slug",children:"Slug"}),(0,r.jsx)(l.I,{id:"slug",value:P.slug,onChange:e=>S(t=>({...t,slug:e.target.value})),placeholder:"premium-cotton-tshirt",required:!0})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(o._,{htmlFor:"description",children:"Description *"}),(0,r.jsx)(d.g,{id:"description",value:P.description,onChange:e=>S(t=>({...t,description:e.target.value})),placeholder:"Detailed product description...",rows:4,required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(o._,{htmlFor:"category",children:"Category *"}),(0,r.jsxs)("select",{id:"category",value:P.categoryId,onChange:e=>S(t=>({...t,categoryId:e.target.value})),className:"w-full h-10 px-3 rounded-md border border-input bg-background",required:!0,children:[(0,r.jsx)("option",{value:"",children:"Select a category"}),w.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]})]}),(0,r.jsxs)(n.Zb,{children:[(0,r.jsx)(n.Ol,{children:(0,r.jsx)(n.ll,{children:"Pricing"})}),(0,r.jsx)(n.aY,{children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(o._,{htmlFor:"basePrice",children:"Base Price (BDT) *"}),(0,r.jsx)(l.I,{id:"basePrice",type:"number",step:"0.01",value:P.basePrice,onChange:e=>S(t=>({...t,basePrice:e.target.value})),placeholder:"1999.00",required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(o._,{htmlFor:"salePrice",children:"Sale Price (BDT)"}),(0,r.jsx)(l.I,{id:"salePrice",type:"number",step:"0.01",value:P.salePrice,onChange:e=>S(t=>({...t,salePrice:e.target.value})),placeholder:"1499.00"})]})]})})]}),(0,r.jsxs)(n.Zb,{children:[(0,r.jsxs)(n.Ol,{children:[(0,r.jsx)(n.ll,{children:"Product Images"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Current images (first image is the main image)"})]}),(0,r.jsx)(n.aY,{className:"space-y-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[C.map((e,t)=>(0,r.jsxs)("div",{className:"relative aspect-square border-2 border-dashed rounded-lg overflow-hidden group",children:[(0,r.jsx)(g.default,{src:e,alt:"Product ".concat(t+1),fill:!0,className:"object-cover"}),(0,r.jsx)("button",{type:"button",onClick:()=>Z(t),className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,r.jsx)(m.Z,{className:"w-4 h-4"})}),0===t&&(0,r.jsx)("div",{className:"absolute bottom-2 left-2 bg-blue-500 text-white text-xs px-2 py-1 rounded",children:"Main"})]},t)),(0,r.jsxs)("label",{className:"aspect-square border-2 border-dashed rounded-lg flex flex-col items-center justify-center cursor-pointer hover:border-blue-500 transition-colors",children:[(0,r.jsx)(h.Z,{className:"w-8 h-8 text-muted-foreground mb-2"}),(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:"Add More"}),(0,r.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:e=>{let t=e.target.files;t&&Array.from(t).forEach(e=>{let t=new FileReader;t.onloadend=()=>{T(e=>[...e,t.result])},t.readAsDataURL(e)})},className:"hidden"})]})]})})]}),(0,r.jsxs)(n.Zb,{children:[(0,r.jsx)(n.Ol,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(n.ll,{children:"Product Variants"}),(0,r.jsxs)(c.z,{type:"button",size:"sm",onClick:()=>{_(e=>[...e,{size:"",color:"",stock:0,sku:""}])},children:[(0,r.jsx)(f.Z,{className:"w-4 h-4 mr-2"}),"Add Variant"]})]})}),(0,r.jsx)(n.aY,{className:"space-y-4",children:I.map((e,t)=>(0,r.jsxs)("div",{className:"p-4 border rounded-lg space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("span",{className:"font-semibold text-sm",children:["Variant ",t+1]}),I.length>1&&(0,r.jsx)(c.z,{type:"button",size:"sm",variant:"ghost",onClick:()=>O(t),children:(0,r.jsx)(m.Z,{className:"w-4 h-4"})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)(o._,{htmlFor:"size-".concat(t),children:"Size"}),(0,r.jsx)(l.I,{id:"size-".concat(t),value:e.size,onChange:e=>D(t,"size",e.target.value),placeholder:"S, M, L, XL"})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)(o._,{htmlFor:"color-".concat(t),children:"Color"}),(0,r.jsx)(l.I,{id:"color-".concat(t),value:e.color,onChange:e=>D(t,"color",e.target.value),placeholder:"Red, Blue, etc."})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)(o._,{htmlFor:"stock-".concat(t),children:"Stock"}),(0,r.jsx)(l.I,{id:"stock-".concat(t),type:"number",value:e.stock,onChange:e=>D(t,"stock",parseInt(e.target.value)||0),placeholder:"100"})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)(o._,{htmlFor:"sku-".concat(t),children:"SKU (Optional)"}),(0,r.jsx)(l.I,{id:"sku-".concat(t),value:e.sku,onChange:e=>D(t,"sku",e.target.value),placeholder:"TSH-M-RED"})]})]})]},t))})]}),(0,r.jsxs)(n.Zb,{children:[(0,r.jsx)(n.Ol,{children:(0,r.jsx)(n.ll,{children:"Product Settings"})}),(0,r.jsx)(n.aY,{className:"space-y-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",checked:P.isFeatured,onChange:e=>S(t=>({...t,isFeatured:e.target.checked})),className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Featured Product"})]}),(0,r.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",checked:P.isBestseller,onChange:e=>S(t=>({...t,isBestseller:e.target.checked})),className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Bestseller"})]}),(0,r.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",checked:P.isActive,onChange:e=>S(t=>({...t,isActive:e.target.checked})),className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Active (Visible on site)"})]})]})})]}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)(c.z,{type:"submit",disabled:j,className:"min-w-[150px]",children:j?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Updating..."]}):"Update Product"}),(0,r.jsx)(x.default,{href:"/admin/products",children:(0,r.jsx)(c.z,{type:"button",variant:"outline",children:"Cancel"})})]})]})]})}},62869:function(e,t,s){"use strict";s.d(t,{d:function(){return l},z:function(){return o}});var r=s(57437),a=s(2265),i=s(37053),n=s(90535),c=s(94508);let l=(0,n.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-md hover:shadow-lg",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=a.forwardRef((e,t)=>{let{className:s,variant:a,size:n,asChild:o=!1,...d}=e,u=o?i.g7:"button";return(0,r.jsx)(u,{className:(0,c.cn)(l({variant:a,size:n,className:s})),ref:t,...d})});o.displayName="Button"},66070:function(e,t,s){"use strict";s.d(t,{Ol:function(){return c},SZ:function(){return o},Zb:function(){return n},aY:function(){return d},ll:function(){return l}});var r=s(57437),a=s(2265),i=s(94508);let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});n.displayName="Card";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",s),...a})});c.displayName="CardHeader";let l=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("h3",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",s),...a})});l.displayName="CardTitle";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("p",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",s),...a})});o.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",s),...a})});d.displayName="CardContent",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",s),...a})}).displayName="CardFooter"},95186:function(e,t,s){"use strict";s.d(t,{I:function(){return n}});var r=s(57437),a=s(2265),i=s(94508);let n=a.forwardRef((e,t)=>{let{className:s,type:a,...n}=e;return(0,r.jsx)("input",{type:a,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...n})});n.displayName="Input"},26815:function(e,t,s){"use strict";s.d(t,{_:function(){return o}});var r=s(57437),a=s(2265),i=s(370),n=s(90535),c=s(94508);let l=(0,n.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(i.f,{ref:t,className:(0,c.cn)(l(),s),...a})});o.displayName=i.f.displayName},76818:function(e,t,s){"use strict";s.d(t,{g:function(){return n}});var r=s(57437),a=s(2265),i=s(94508);let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...a})});n.displayName="Textarea"},35153:function(e,t,s){"use strict";s.d(t,{pm:function(){return p}});var r=s(2265);let a=0,i=new Map,n=e=>{if(i.has(e))return;let t=setTimeout(()=>{i.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,t)},c=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?n(s):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],o={toasts:[]};function d(e){o=c(o,e),l.forEach(e=>{e(o)})}function u(e){let{...t}=e,s=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>d({type:"DISMISS_TOAST",toastId:s});return d({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||r()}}}),{id:s,dismiss:r,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function p(){let[e,t]=r.useState(o);return r.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},94508:function(e,t,s){"use strict";s.d(t,{T4:function(){return n},cn:function(){return i}});var r=s(61994),a=s(53335);function i(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.m6)((0,r.W)(t))}function n(e){return new Intl.NumberFormat("en-BD",{style:"currency",currency:"BDT",minimumFractionDigits:0}).format(e)}},32660:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(79205).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},51817:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(79205).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},99397:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(79205).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},17689:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(79205).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},32489:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(79205).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},99376:function(e,t,s){"use strict";var r=s(35475);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},370:function(e,t,s){"use strict";s.d(t,{f:function(){return l}});var r=s(2265);s(54887);var a=s(37053),i=s(57437),n=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let s=(0,a.Z8)(`Primitive.${t}`),n=r.forwardRef((e,r)=>{let{asChild:a,...n}=e,c=a?s:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,i.jsx)(c,{...n,ref:r})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{}),c=r.forwardRef((e,t)=>(0,i.jsx)(n.label,{...e,ref:t,onMouseDown:t=>{var s;t.target.closest("button, input, select, textarea")||(null===(s=e.onMouseDown)||void 0===s||s.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));c.displayName="Label";var l=c}},function(e){e.O(0,[8590,5650,3145,2971,2117,1744],function(){return e(e.s=78633)}),_N_E=e.O()}]);