(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6136],{10720:function(e,s,t){Promise.resolve().then(t.bind(t,64249))},64249:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return v}});var a=t(57437),n=t(2265),i=t(66070),l=t(62869),r=t(35974),c=t(84190),d=t(26815),o=t(76818),u=t(26110),x=t(94508),h=t(51817),m=t(17580),p=t(71533),j=t(35153);function v(){let{toast:e}=(0,j.pm)(),[s,t]=(0,n.useState)(!0),[v,f]=(0,n.useState)([]),[g,N]=(0,n.useState)("all"),[y,b]=(0,n.useState)(null),[k,w]=(0,n.useState)(""),[C,S]=(0,n.useState)(""),[_,z]=(0,n.useState)(!1),q=async()=>{try{t(!0);let e=await fetch("/api/admin/payouts?status=".concat(g));if(e.ok){let s=await e.json();f(s.payouts||[])}}finally{t(!1)}};(0,n.useEffect)(()=>{q()},[g]);let R=(e,s)=>{b(e),w(s),S("")},Z=async()=>{if(y&&k){z(!0);try{(await fetch("/api/admin/payouts",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:y.id,action:k,note:C})})).ok?(e({title:"Success",description:"Request ".concat(k,"ed successfully")}),q(),b(null)):e({title:"Failed",variant:"destructive"})}catch(s){e({title:"Error",variant:"destructive"})}finally{z(!1)}}},A=e=>{switch(e){case"paid":return"bg-green-100 text-green-700";case"approved":return"bg-blue-100 text-blue-700";case"rejected":return"bg-red-100 text-red-700";default:return"bg-orange-100 text-orange-700"}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Payout Requests"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Manage seller withdrawal requests"})]}),(0,a.jsx)("div",{className:"flex items-center gap-2 bg-white p-1 rounded-lg border",children:["all","pending","approved","paid","rejected"].map(e=>(0,a.jsx)("button",{onClick:()=>N(e),className:"px-3 py-1.5 text-sm rounded-md capitalize transition ".concat(g===e?"bg-gray-100 font-medium text-gray-900":"text-gray-500 hover:text-gray-700"),children:e},e))})]}),(0,a.jsx)(i.Zb,{children:(0,a.jsx)(i.aY,{className:"p-0",children:s?(0,a.jsx)("div",{className:"p-12 flex justify-center",children:(0,a.jsx)(h.Z,{className:"animate-spin text-gray-400"})}):0===v.length?(0,a.jsx)("div",{className:"p-12 text-center text-gray-500",children:"No requests found"}):(0,a.jsx)("div",{className:"divide-y",children:v.map(e=>{var s,t,n,i;return(0,a.jsxs)("div",{className:"p-4 flex flex-col sm:flex-row gap-4 items-start sm:items-center hover:bg-gray-50 transition",children:[(0,a.jsx)("div",{className:"p-2 rounded-full hidden sm:block ".concat(A(e.status)),children:(0,a.jsx)(m.Z,{className:"w-5 h-5"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsx)("p",{className:"font-semibold text-gray-900 truncate",children:(null===(s=e.user)||void 0===s?void 0:s.name)||"Seller"}),(0,a.jsx)("span",{className:"sm:hidden text-sm font-bold",children:(0,x.T4)(e.amount)})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 truncate",children:[null===(t=e.user)||void 0===t?void 0:t.email," â€¢ ",null===(i=e.user)||void 0===i?void 0:null===(n=i.shop)||void 0===n?void 0:n.name]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2 mt-2 text-xs text-gray-500",children:[(0,a.jsx)(r.C,{variant:"secondary",className:"uppercase",children:e.method}),(0,a.jsx)("span",{children:new Date(e.createdAt).toLocaleDateString()}),e.details&&(0,a.jsx)("span",{className:"font-mono bg-gray-100 px-1 rounded",children:JSON.parse(e.details).accountNumber||e.details})]})]}),(0,a.jsxs)("div",{className:"hidden sm:block text-right",children:[(0,a.jsx)("p",{className:"font-bold text-lg",children:(0,x.T4)(e.amount)}),(0,a.jsx)(r.C,{className:"capitalize mt-1 ".concat(A(e.status)," hover:bg-opacity-80"),children:e.status})]}),(0,a.jsxs)("div",{className:"flex sm:hidden items-center justify-between w-full mt-2 pt-2 border-t",children:[(0,a.jsx)(r.C,{className:"capitalize ".concat(A(e.status)),children:e.status}),"pending"===e.status&&(0,a.jsx)(l.z,{size:"sm",variant:"outline",onClick:()=>R(e,"approve"),children:"Review"})]}),(0,a.jsx)("div",{className:"hidden sm:block",children:(0,a.jsxs)(c.h_,{children:[(0,a.jsx)(c.$F,{asChild:!0,children:(0,a.jsx)(l.z,{variant:"ghost",size:"icon",children:(0,a.jsx)(p.Z,{className:"w-4 h-4"})})}),(0,a.jsxs)(c.AW,{align:"end",children:[(0,a.jsx)(c.Ju,{children:"Actions"}),(0,a.jsx)(c.VD,{}),"pending"===e.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.Xi,{onClick:()=>R(e,"approve"),children:"Approve Request"}),(0,a.jsx)(c.Xi,{onClick:()=>R(e,"reject"),className:"text-red-600",children:"Reject Request"})]}),"approved"===e.status&&(0,a.jsx)(c.Xi,{onClick:()=>R(e,"mark_paid"),children:"Mark as Paid"}),(0,a.jsx)(c.Xi,{onClick:()=>navigator.clipboard.writeText(e.id),children:"Copy ID"})]})]})})]},e.id)})})})}),(0,a.jsx)(u.Vq,{open:!!y,onOpenChange:e=>!e&&b(null),children:(0,a.jsxs)(u.cZ,{children:[(0,a.jsxs)(u.fK,{children:[(0,a.jsxs)(u.$N,{className:"capitalize",children:[k&&k.replace("_"," ")," Request"]}),(0,a.jsx)(u.Be,{children:"approve"===k?"Approve this request for payment processing?":"mark_paid"===k?"Confirm that you have sent the money?":"Reject this payout request?"})]}),(0,a.jsxs)("div",{className:"py-2",children:[(0,a.jsx)(d._,{children:"Admin Note (Optional)"}),(0,a.jsx)(o.g,{value:C,onChange:e=>S(e.target.value),placeholder:"Transaction ID or reason...",className:"mt-2"})]}),(0,a.jsxs)(u.cN,{children:[(0,a.jsx)(l.z,{variant:"outline",onClick:()=>b(null),children:"Cancel"}),(0,a.jsxs)(l.z,{onClick:Z,disabled:_,variant:"reject"===k?"destructive":"default",className:"mark_paid"===k?"bg-green-600 hover:bg-green-700":"",children:[_&&(0,a.jsx)(h.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Confirm"]})]})]})})]})}},17580:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(79205).Z)("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]])}},function(e){e.O(0,[8590,6053,1,9923,90,2074,2971,2117,1744],function(){return e(e.s=10720)}),_N_E=e.O()}]);