(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1436],{1578:function(e,s,t){Promise.resolve().then(t.bind(t,63775))},63775:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return N}});var r=t(57437),n=t(2265),a=t(36891),i=t(89345),l=t(82431),c=t(95805),d=t(51817),o=t(44743),u=t(30401),m=t(32489),f=t(76980),x=t(18930),h=t(62869),g=t(66070),p=t(95186),b=t(26815),j=t(19060);function N(){let[e,s]=(0,n.useState)([]),[t,N]=(0,n.useState)([]),[y,v]=(0,n.useState)(!0),[w,S]=(0,n.useState)(!1),[k,C]=(0,n.useState)(""),[Z,z]=(0,n.useState)(""),[F,_]=(0,n.useState)([]),[R,T]=(0,n.useState)(null),E=(0,n.useRef)(null);(0,n.useEffect)(()=>{M()},[]);let M=async()=>{v(!0);try{let e=await fetch("/api/admin/email",{credentials:"include"});if(e.ok){let t=await e.json();s(t.subscribers||[])}}catch(e){console.error("Failed to fetch subscribers:",e)}finally{v(!1)}},A=e=>{t.includes(e)?N(t.filter(s=>s!==e)):N([...t,e])},B=e=>{_(s=>s.filter((s,t)=>t!==e))},O=e=>e<1024?e+" B":e<1048576?(e/1024).toFixed(1)+" KB":(e/1048576).toFixed(1)+" MB",P=async()=>{if(!k.trim()||!Z.trim()){T({type:"error",message:"Subject and message are required"});return}S(!0),T(null);try{let e=await fetch("/api/admin/email",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({subject:k,message:Z,recipients:t.length>0?t:void 0,attachments:F.length>0?F:void 0})}),s=await e.json();e.ok?(T({type:"success",message:s.message}),C(""),z(""),N([]),_([])):T({type:"error",message:s.error||"Failed to send emails"})}catch(e){T({type:"error",message:e.message||"Failed to send emails"})}finally{S(!1)}};return(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold flex items-center gap-3",children:[(0,r.jsx)(i.Z,{className:"w-8 h-8 text-blue-600"}),"Email Marketing"]}),(0,r.jsx)("p",{className:"text-muted-foreground mt-1",children:"Send emails to newsletter subscribers"})]}),(0,r.jsxs)(h.z,{variant:"outline",onClick:M,disabled:y,children:[(0,r.jsx)(l.Z,{className:"w-4 h-4 mr-2 ".concat(y?"animate-spin":"")}),"Refresh"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsxs)(g.Zb,{className:"lg:col-span-1",children:[(0,r.jsxs)(g.Ol,{children:[(0,r.jsxs)(g.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(c.Z,{className:"w-5 h-5"}),"Subscribers (",e.length,")"]}),(0,r.jsx)(g.SZ,{children:"Select recipients or send to all"})]}),(0,r.jsx)(g.aY,{children:y?(0,r.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,r.jsx)(d.Z,{className:"w-6 h-6 animate-spin text-blue-600"})}):0===e.length?(0,r.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"No subscribers yet"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)(h.z,{variant:"outline",size:"sm",onClick:()=>{t.length===e.length?N([]):N(e.map(e=>e.email))},className:"w-full",children:t.length===e.length?"Deselect All":"Select All"})}),(0,r.jsx)("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:e.map(e=>(0,r.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-colors ".concat(t.includes(e.email)?"bg-blue-50 border-blue-200":"hover:bg-gray-50"),onClick:()=>A(e.email),children:[(0,r.jsx)(j.X,{checked:t.includes(e.email),onCheckedChange:()=>A(e.email)}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"font-medium text-sm truncate",children:e.email}),e.name&&(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:e.name})]})]},e.id))}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground mt-4 text-center",children:t.length>0?"".concat(t.length," selected"):"No selection = send to all"})]})})]}),(0,r.jsxs)(g.Zb,{className:"lg:col-span-2",children:[(0,r.jsxs)(g.Ol,{children:[(0,r.jsxs)(g.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(o.Z,{className:"w-5 h-5"}),"Compose Email"]}),(0,r.jsx)(g.SZ,{children:"Write your email content. HTML is supported in the message."})]}),(0,r.jsxs)(g.aY,{className:"space-y-4",children:[R&&(0,r.jsxs)(a.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"p-4 rounded-lg flex items-center gap-2 ".concat("success"===R.type?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"),children:["success"===R.type?(0,r.jsx)(u.Z,{className:"w-5 h-5"}):(0,r.jsx)(m.Z,{className:"w-5 h-5"}),R.message]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(b._,{htmlFor:"subject",children:"Subject *"}),(0,r.jsx)(p.I,{id:"subject",placeholder:"Enter email subject...",value:k,onChange:e=>C(e.target.value)})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(b._,{htmlFor:"message",children:"Message *"}),(0,r.jsx)("textarea",{id:"message",rows:10,placeholder:"Write your email message here...",value:Z,onChange:e=>z(e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Tip: Use line breaks for paragraphs. Basic HTML tags are supported."})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(b._,{children:"Attachments"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)(h.z,{type:"button",variant:"outline",onClick:()=>{var e;return null===(e=E.current)||void 0===e?void 0:e.click()},children:[(0,r.jsx)(f.Z,{className:"w-4 h-4 mr-2"}),"Add File"]}),(0,r.jsx)("input",{ref:E,type:"file",multiple:!0,className:"hidden",onChange:e=>{let s=e.target.files;s&&(Array.from(s).forEach(e=>{if(e.size>10485760){alert("File ".concat(e.name," is too large (max 10MB)"));return}let s=new FileReader;s.onloadend=()=>{let t=s.result.split(",")[1];_(s=>[...s,{name:e.name,size:e.size,type:e.type,data:t}])},s.readAsDataURL(e)}),E.current&&(E.current.value=""))}})]}),F.length>0&&(0,r.jsx)("div",{className:"space-y-2 mt-3",children:F.map((e,s)=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(f.Z,{className:"w-4 h-4 text-gray-500"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium truncate max-w-[200px]",children:e.name}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:O(e.size)})]})]}),(0,r.jsx)(h.z,{variant:"ghost",size:"sm",onClick:()=>B(s),className:"text-red-500 hover:text-red-700 hover:bg-red-50",children:(0,r.jsx)(x.Z,{className:"w-4 h-4"})})]},s))})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t",children:[(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Sending to: ",t.length>0?"".concat(t.length," recipients"):"All ".concat(e.length," subscribers"),F.length>0&&" â€¢ ".concat(F.length," attachment(s)")]}),(0,r.jsx)(h.z,{onClick:P,disabled:w||!k||!Z||0===e.length,className:"min-w-[140px]",children:w?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Sending..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{className:"w-4 h-4 mr-2"}),"Send Email"]})})]})]})]})]}),(0,r.jsx)(g.Zb,{className:"mt-6",children:(0,r.jsx)(g.aY,{className:"pt-6",children:(0,r.jsxs)("div",{className:"flex items-start gap-4",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,r.jsx)(i.Z,{className:"w-5 h-5 text-blue-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold mb-1",children:"SMTP Configuration"}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Emails are sent using the SMTP settings in your ",(0,r.jsx)("code",{className:"bg-gray-100 px-1 rounded",children:".env"})," file. Make sure you have configured ",(0,r.jsx)("code",{className:"bg-gray-100 px-1 rounded",children:"SMTP_HOST"}),",",(0,r.jsx)("code",{className:"bg-gray-100 px-1 rounded",children:"SMTP_USER"}),", and",(0,r.jsx)("code",{className:"bg-gray-100 px-1 rounded",children:"SMTP_PASS"}),"."]})]})]})})})]})}},62869:function(e,s,t){"use strict";t.d(s,{d:function(){return c},z:function(){return d}});var r=t(57437),n=t(2265),a=t(37053),i=t(90535),l=t(94508);let c=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-md hover:shadow-lg",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=n.forwardRef((e,s)=>{let{className:t,variant:n,size:i,asChild:d=!1,...o}=e,u=d?a.g7:"button";return(0,r.jsx)(u,{className:(0,l.cn)(c({variant:n,size:i,className:t})),ref:s,...o})});d.displayName="Button"},66070:function(e,s,t){"use strict";t.d(s,{Ol:function(){return l},SZ:function(){return d},Zb:function(){return i},aY:function(){return o},ll:function(){return c}});var r=t(57437),n=t(2265),a=t(94508);let i=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,r.jsx)("div",{ref:s,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...n})});i.displayName="Card";let l=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,r.jsx)("div",{ref:s,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",t),...n})});l.displayName="CardHeader";let c=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,r.jsx)("h3",{ref:s,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",t),...n})});c.displayName="CardTitle";let d=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,r.jsx)("p",{ref:s,className:(0,a.cn)("text-sm text-muted-foreground",t),...n})});d.displayName="CardDescription";let o=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,r.jsx)("div",{ref:s,className:(0,a.cn)("p-6 pt-0",t),...n})});o.displayName="CardContent",n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,r.jsx)("div",{ref:s,className:(0,a.cn)("flex items-center p-6 pt-0",t),...n})}).displayName="CardFooter"},19060:function(e,s,t){"use strict";t.d(s,{X:function(){return c}});var r=t(57437),n=t(2265),a=t(9270),i=t(30401),l=t(94508);let c=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,r.jsx)(a.fC,{ref:s,className:(0,l.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...n,children:(0,r.jsx)(a.z$,{className:(0,l.cn)("flex items-center justify-center text-current"),children:(0,r.jsx)(i.Z,{className:"h-4 w-4"})})})});c.displayName=a.fC.displayName},95186:function(e,s,t){"use strict";t.d(s,{I:function(){return i}});var r=t(57437),n=t(2265),a=t(94508);let i=n.forwardRef((e,s)=>{let{className:t,type:n,...i}=e;return(0,r.jsx)("input",{type:n,className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...i})});i.displayName="Input"},26815:function(e,s,t){"use strict";t.d(s,{_:function(){return d}});var r=t(57437),n=t(2265),a=t(370),i=t(90535),l=t(94508);let c=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,r.jsx)(a.f,{ref:s,className:(0,l.cn)(c(),t),...n})});d.displayName=a.f.displayName},94508:function(e,s,t){"use strict";t.d(s,{T4:function(){return i},cn:function(){return a}});var r=t(61994),n=t(53335);function a(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,n.m6)((0,r.W)(s))}function i(e){return new Intl.NumberFormat("en-BD",{style:"currency",currency:"BDT",minimumFractionDigits:0}).format(e)}}},function(e){e.O(0,[8590,6891,6053,2986,2971,2117,1744],function(){return e(e.s=1578)}),_N_E=e.O()}]);