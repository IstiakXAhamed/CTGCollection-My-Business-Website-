(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7004],{53147:function(e,t,s){Promise.resolve().then(s.bind(s,94473))},94473:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return g}});var a=s(57437),n=s(2265),r=s(99376),i=s(36891),l=s(51817),c=s(89345),o=s(30401),d=s(76865),u=s(88906),m=s(13041),f=s(62869),x=s(66070),h=s(1828),b=s(27648);function g(){let e=(0,r.useRouter)(),[t,s]=(0,n.useState)(!0),[g,p]=(0,n.useState)(!1),[y,j]=(0,n.useState)(null),[v,N]=(0,n.useState)(!1),[w,k]=(0,n.useState)("email"),[S,C]=(0,n.useState)(!1),[F,Z]=(0,n.useState)("enable"),[E,T]=(0,n.useState)(""),[R,A]=(0,n.useState)(!1),[D,V]=(0,n.useState)({type:"",text:""});(0,n.useEffect)(()=>{O()},[]);let O=async()=>{try{let t=await fetch("/api/auth/me");if(t.ok){let e=await t.json();j(e.user),N(e.user.twoFactorEnabled||!1),k(e.user.twoFactorMethod||"email")}else e.push("/login")}catch(e){console.error("Failed to fetch user:",e)}finally{s(!1)}},_=async()=>{if(v)Z("disable"),C(!0);else{Z("enable"),p(!0);try{let e=await fetch("/api/user/settings/2fa",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"send-code",method:w})}),t=await e.json();e.ok?(C(!0),V({type:"success",text:"Verification code sent to your email"})):V({type:"error",text:t.message})}catch(e){V({type:"error",text:"Failed to send verification code"})}finally{p(!1)}}},z=async()=>{A(!0);try{let e=await fetch("/api/user/settings/2fa",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:F,method:w,code:E})}),t=await e.json();e.ok?(N("enable"===F),C(!1),T(""),V({type:"success",text:"enable"===F?"Two-factor authentication enabled successfully!":"Two-factor authentication disabled"}),O()):V({type:"error",text:t.message})}catch(e){V({type:"error",text:"Operation failed"})}finally{A(!1)}};return t?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)(l.Z,{className:"w-8 h-8 animate-spin text-blue-600"})}):(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 py-12 px-4",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)(b.default,{href:"/account",className:"text-blue-600 hover:underline text-sm mb-2 inline-block",children:"â† Back to Account"}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Security Settings"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage your account security and two-factor authentication"})]}),D.text&&(0,a.jsx)(i.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6 p-4 rounded-lg ".concat("success"===D.type?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"),children:D.text}),(0,a.jsx)(x.Zb,{className:"mb-6",children:(0,a.jsx)(x.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-full flex items-center justify-center ".concat((null==y?void 0:y.emailVerified)?"bg-green-100":"bg-yellow-100"),children:(0,a.jsx)(c.Z,{className:"w-6 h-6 ".concat((null==y?void 0:y.emailVerified)?"text-green-600":"text-yellow-600")})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold",children:"Email Verification"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:null==y?void 0:y.email})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium ".concat((null==y?void 0:y.emailVerified)?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"),children:(null==y?void 0:y.emailVerified)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.Z,{className:"w-4 h-4"}),"Verified"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.Z,{className:"w-4 h-4"}),"Not Verified"]})})]})})}),(0,a.jsxs)(x.Zb,{children:[(0,a.jsxs)(x.Ol,{children:[(0,a.jsxs)(x.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(u.Z,{className:"w-5 h-5 text-blue-600"}),"Two-Factor Authentication"]}),(0,a.jsx)(x.SZ,{children:"Add an extra layer of security to your account by requiring a verification code when you sign in."})]}),(0,a.jsxs)(x.aY,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium",children:"Enable 2FA"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:v?"Your account is protected with 2FA":"Protect your account with two-factor authentication"})]}),(0,a.jsx)(h.r,{checked:v,onCheckedChange:_,disabled:g})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Verification Method"}),(0,a.jsxs)("button",{onClick:()=>k("email"),className:"w-full p-4 rounded-lg border-2 flex items-center justify-between transition ".concat("email"===w?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(c.Z,{className:"w-5 h-5 ".concat("email"===w?"text-blue-600":"text-gray-400")}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:"font-medium",children:"Email"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Receive codes via email"})]})]}),"email"===w&&(0,a.jsx)(o.Z,{className:"w-5 h-5 text-blue-600"})]}),(0,a.jsxs)("button",{onClick:()=>k("sms"),className:"w-full p-4 rounded-lg border-2 flex items-center justify-between transition ".concat("sms"===w?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"," ").concat((null==y?void 0:y.phone)?"":"opacity-50 cursor-not-allowed"),disabled:!(null==y?void 0:y.phone),children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(m.Z,{className:"w-5 h-5 ".concat("sms"===w?"text-blue-600":"text-gray-400")}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:"font-medium",children:"SMS"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:(null==y?void 0:y.phone)?"Receive codes via SMS to ".concat(y.phone):"Add phone number to enable"})]})]}),"sms"===w&&(null==y?void 0:y.phone)&&(0,a.jsx)(o.Z,{className:"w-5 h-5 text-blue-600"})]})]}),(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-100",children:[(0,a.jsx)("h4",{className:"font-medium text-blue-800 mb-1",children:"\uD83D\uDD10 Security Tip"}),(0,a.jsx)("p",{className:"text-sm text-blue-700",children:"Two-factor authentication helps protect your account even if someone knows your password. We'll send a verification code each time you sign in from a new device."})]})]})]}),S&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)(i.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"bg-white rounded-xl p-6 max-w-md w-full shadow-2xl",children:[(0,a.jsx)("h3",{className:"text-xl font-bold mb-4",children:"enable"===F?"Enable 2FA":"Disable 2FA"}),"enable"===F?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"Enter the 6-digit code sent to your email to enable two-factor authentication."}),(0,a.jsx)("input",{type:"text",placeholder:"Enter 6-digit code",value:E,onChange:e=>T(e.target.value.replace(/\D/g,"").slice(0,6)),className:"w-full px-4 py-3 border-2 rounded-lg text-center text-2xl tracking-widest font-mono mb-4",maxLength:6})]}):(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"Are you sure you want to disable two-factor authentication? Your account will be less secure."}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(f.z,{variant:"outline",className:"flex-1",onClick:()=>{C(!1),T("")},children:"Cancel"}),(0,a.jsx)(f.z,{className:"flex-1",onClick:z,disabled:R||"enable"===F&&6!==E.length,children:R?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):"Confirm"})]})]})})]})})}},62869:function(e,t,s){"use strict";s.d(t,{d:function(){return c},z:function(){return o}});var a=s(57437),n=s(2265),r=s(37053),i=s(90535),l=s(94508);let c=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-md hover:shadow-lg",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=n.forwardRef((e,t)=>{let{className:s,variant:n,size:i,asChild:o=!1,...d}=e,u=o?r.g7:"button";return(0,a.jsx)(u,{className:(0,l.cn)(c({variant:n,size:i,className:s})),ref:t,...d})});o.displayName="Button"},66070:function(e,t,s){"use strict";s.d(t,{Ol:function(){return l},SZ:function(){return o},Zb:function(){return i},aY:function(){return d},ll:function(){return c}});var a=s(57437),n=s(2265),r=s(94508);let i=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...n})});i.displayName="Card";let l=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",s),...n})});l.displayName="CardHeader";let c=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("h3",{ref:t,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",s),...n})});c.displayName="CardTitle";let o=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("p",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",s),...n})});o.displayName="CardDescription";let d=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",s),...n})});d.displayName="CardContent",n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",s),...n})}).displayName="CardFooter"},1828:function(e,t,s){"use strict";s.d(t,{r:function(){return l}});var a=s(57437),n=s(2265),r=s(50721),i=s(94508);let l=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.fC,{className:(0,i.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...n,ref:t,children:(0,a.jsx)(r.bU,{className:(0,i.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});l.displayName=r.fC.displayName},94508:function(e,t,s){"use strict";s.d(t,{T4:function(){return i},cn:function(){return r}});var a=s(61994),n=s(53335);function r(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,n.m6)((0,a.W)(t))}function i(e){return new Intl.NumberFormat("en-BD",{style:"currency",currency:"BDT",minimumFractionDigits:0}).format(e)}}},function(e){e.O(0,[8590,6891,5650,2947,2971,2117,1744],function(){return e(e.s=53147)}),_N_E=e.O()}]);